!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.MapboxDraw=t():e.MapboxDraw=t()}(window,function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=41)}([function(e,t,n){"use strict";t.g={classes:{CONTROL_BASE:"mapboxgl-ctrl",CONTROL_PREFIX:"mapboxgl-ctrl-",CONTROL_BUTTON:"mapbox-gl-draw_ctrl-draw-btn",CONTROL_BUTTON_CIRCLE:"mapbox-gl-draw_circle",CONTROL_BUTTON_TRIANGLE:"mapbox-gl-draw_triangle",CONTROL_BUTTON_RECTANGLE:"mapbox-gl-draw_rectangle",CONTROL_BUTTON_SECTOR:"mapbox-gl-draw_sector",CONTROL_BUTTON_ARROW:"mapbox-gl-draw_arrow",CONTROL_BUTTON_LINE:"mapbox-gl-draw_line",CONTROL_BUTTON_POLYGON:"mapbox-gl-draw_polygon",CONTROL_BUTTON_POINT:"mapbox-gl-draw_point",CONTROL_BUTTON_TRASH:"mapbox-gl-draw_trash",CONTROL_BUTTON_COMBINE_FEATURES:"mapbox-gl-draw_combine",CONTROL_BUTTON_UNCOMBINE_FEATURES:"mapbox-gl-draw_uncombine",CONTROL_GROUP:"mapboxgl-ctrl-group",ATTRIBUTION:"mapboxgl-ctrl-attrib",ACTIVE_BUTTON:"active",BOX_SELECT:"mapbox-gl-draw_boxselect"},sources:{HOT:"mapbox-gl-draw-hot",COLD:"mapbox-gl-draw-cold"},cursors:{ADD:"add",MOVE:"move",DRAG:"drag",POINTER:"pointer",NONE:"none"},types:{CIRCLE:"circle",POLYGON:"polygon",LINE:"line_string",POINT:"point",TRIANGLE:"triangle",RECTANGLE:"rectangle",SECTOR:"sector",ARROW:"arrow"},geojsonTypes:{CIRCLE:"Circle",TRIANGLE:"Triangle",RECTANGLE:"Rectangle",SECTOR:"Sector",ARROW:"Arrow",FEATURE:"Feature",POLYGON:"Polygon",LINE_STRING:"LineString",POINT:"Point",FEATURE_COLLECTION:"FeatureCollection",MULTI_PREFIX:"Multi",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon"},modes:{DRAW_CIRCLE:"draw_circle",DRAW_TRIANGLE:"draw_triangle",DRAW_RECTANGLE:"draw_rectangle",DRAW_SECTOR:"draw_sector",DRAW_ARROW:"draw_arrow",DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select",STATIC:"static"},events:{CREATE:"draw.create",DELETE:"draw.delete",UPDATE:"draw.update",SELECTION_CHANGE:"draw.selectionchange",MODE_CHANGE:"draw.modechange",ACTIONABLE:"draw.actionable",RENDER:"draw.render",COMBINE_FEATURES:"draw.combine",UNCOMBINE_FEATURES:"draw.uncombine",REPLACE:"draw.replace",RECORD_CREATE:"draw.record.create",UNDO:"draw.undo",REDO:"draw.redo",SELECTED:"draw.selected"},updateActions:{MOVE:"move",CHANGE_COORDINATES:"change_coordinates",CHANGE_PROPERTIES:"change_properties"},meta:{FEATURE:"feature",MIDPOINT:"midpoint",VERTEX:"vertex"},activeStates:{ACTIVE:"true",INACTIVE:"false"},interactions:["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],LAT_MIN:-90,LAT_RENDERED_MIN:-85,LAT_MAX:90,LAT_RENDERED_MAX:85,LNG_MIN:-270,LNG_MAX:270}},function(e,t,n){"use strict";var o=n(0);t.a={isOfMetaType:function(e){return function(t){const n=t.featureTarget;return!!n&&(!!n.properties&&n.properties.meta===e)}},isShiftMousedown:function(e){return!!e.originalEvent&&(!!e.originalEvent.shiftKey&&0===e.originalEvent.button)},isActiveFeature:function(e){return!!e.featureTarget&&(!!e.featureTarget.properties&&(e.featureTarget.properties.active===o.g.activeStates.ACTIVE&&e.featureTarget.properties.meta===o.g.meta.FEATURE))},isInactiveFeature:function(e){return!!e.featureTarget&&(!!e.featureTarget.properties&&(e.featureTarget.properties.active===o.g.activeStates.INACTIVE&&e.featureTarget.properties.meta===o.g.meta.FEATURE))},noTarget:function(e){return void 0===e.featureTarget},isFeature:function(e){return!!e.featureTarget&&(!!e.featureTarget.properties&&e.featureTarget.properties.meta===o.g.meta.FEATURE)},isVertex:function(e){const t=e.featureTarget;return!!t&&(!!t.properties&&t.properties.meta===o.g.meta.VERTEX)},isShiftDown:function(e){return!!e.originalEvent&&!0===e.originalEvent.shiftKey},isEscapeKey:function(e){return 27===e.keyCode},isEnterKey:function(e){return 13===e.keyCode},true:function(){return!0}}},function(e,t,n){"use strict";t.a={enable(e){setTimeout(()=>{e.map&&e.map.doubleClickZoom&&e._ctx&&e._ctx.store&&e._ctx.store.getInitialConfigValue&&e._ctx.store.getInitialConfigValue("doubleClickZoom")&&e.map.doubleClickZoom.enable()},0)},disable(e){setTimeout(()=>{e.map&&e.map.doubleClickZoom&&e.map.doubleClickZoom.disable()},0)}}},function(e,t,n){"use strict";var o=n(0);t.a=function(e,t,n,r){return{type:o.g.geojsonTypes.FEATURE,properties:{meta:o.g.meta.VERTEX,parent:e,coord_path:n,active:r?o.g.activeStates.ACTIVE:o.g.activeStates.INACTIVE},geometry:{type:o.g.geojsonTypes.POINT,coordinates:t}}}},function(e,t,n){"use strict";function o(e,t){return!!e.lngLat&&(e.lngLat.lng===t[0]&&e.lngLat.lat===t[1])}n.d(t,"a",function(){return o})},function(e,t){e.exports=function(){for(var e={},t=0;t<arguments.length;t++){var o=arguments[t];for(var r in o)n.call(o,r)&&(e[r]=o[r])}return e};var n=Object.prototype.hasOwnProperty},function(e,t,n){"use strict";n.d(t,"a",function(){return o});class o{constructor(e){if(this._items={},this._nums={},this._length=e?e.length:0,e)for(let t=0,n=e.length;t<n;t++)this.add(e[t]),void 0!==e[t]&&("string"==typeof e[t]?this._items[e[t]]=t:this._nums[e[t]]=t)}add(e){return this.has(e)?this:(this._length++,"string"==typeof e?this._items[e]=this._length:this._nums[e]=this._length,this)}delete(e){return!1===this.has(e)?this:(this._length--,delete this._items[e],delete this._nums[e],this)}has(e){return("string"==typeof e||"number"==typeof e)&&(void 0!==this._items[e]||void 0!==this._nums[e])}values(){const e=[];return Object.keys(this._items).forEach(t=>{e.push({k:t,v:this._items[t]})}),Object.keys(this._nums).forEach(t=>{e.push({k:JSON.parse(t),v:this._nums[t]})}),e.sort((e,t)=>e.v-t.v).map(e=>e.k)}clear(){return this._length=0,this._items={},this._nums={},this}}},function(e,t,n){"use strict";var o=n(40),r=n.n(o),i=n(0);const s={Point:0,LineString:1,Polygon:2};function a(e,t){const n=s[e.geometry.type]-s[t.geometry.type];return 0===n&&e.geometry.type===i.g.geojsonTypes.POLYGON?e.area-t.area:n}var c=function(e){return e.map(e=>(e.geometry.type===i.g.geojsonTypes.POLYGON&&(e.area=r.a.geometry({type:i.g.geojsonTypes.FEATURE,property:{},geometry:e.geometry})),e)).sort(a).map(e=>(delete e.area,e))};var u=n(6);const l=[i.g.meta.FEATURE,i.g.meta.MIDPOINT,i.g.meta.VERTEX];function d(e,t,n,o){if(null===n.map)return[];const r=e?function(e,t=0){return[[e.point.x-t,e.point.y-t],[e.point.x+t,e.point.y+t]]}(e,o):t,i={};n.options.styles&&(i.layers=n.options.styles.map(e=>e.id));const s=n.map.queryRenderedFeatures(r,i).filter(e=>-1!==l.indexOf(e.properties.meta)),a=new u.a,d=[];return s.forEach(e=>{const t=e.properties.id;a.has(t)||(a.add(t),d.push(e))}),c(d)}t.a={click:function(e,t,n){return d(e,t,n,n.options.clickBuffer)},touch:function(e,t,n){return d(e,t,n,n.options.touchBuffer)}}},function(e,t,n){"use strict";n.d(t,"a",function(){return h});var o=n(9),r=n(0),i=n(14),s=n.n(i),a=n(12),c=n(11),u=n(10);const l={MultiPoint:a.a,MultiLineString:c.a,MultiPolygon:u.a},d=(e,t,n,o,r)=>{const i=n.split("."),s=parseInt(i[0],10),a=i[1]?i.slice(1).join("."):null;return e[s][t](a,o,r)};class h extends o.a{constructor(e,t){if(super(e,t),delete this.coordinates,this.model=l[t.geometry.type],void 0===this.model)throw new TypeError(`${t.geometry.type} is not a valid type`);this.features=this._coordinatesToFeatures(t.geometry.coordinates)}_coordinatesToFeatures(e){const t=this.model.bind(this);return e.map(e=>new t(this.ctx,{id:s()(),type:r.g.geojsonTypes.FEATURE,properties:{},geometry:{coordinates:e,type:this.type.replace("Multi","")}}))}isValid(){return this.features.every(e=>e.isValid())}setCoordinates(e){this.features=this._coordinatesToFeatures(e),this.changed()}getCoordinate(e){return d(this.features,"getCoordinate",e)}getCoordinates(){return JSON.parse(JSON.stringify(this.features.map(e=>e.type===r.g.geojsonTypes.POLYGON?e.getCoordinates():e.coordinates)))}updateCoordinate(e,t,n){d(this.features,"updateCoordinate",e,t,n),this.changed()}addCoordinate(e,t,n){d(this.features,"addCoordinate",e,t,n),this.changed()}removeCoordinate(e){d(this.features,"removeCoordinate",e),this.changed()}getFeatures(){return this.features}}},function(e,t,n){"use strict";n.d(t,"a",function(){return s});var o=n(14),r=n.n(o),i=n(0);class s{constructor(e,t){this.ctx=e,this.properties=t.properties||{},this.coordinates=t.geometry.coordinates,this.id=t.id||r()(),this.type=t.geometry.type}changed(){this.ctx.store.featureChanged(this.id)}incomingCoords(e){this.setCoordinates(e)}setCoordinates(e){this.coordinates=e,this.changed()}getCoordinates(){return JSON.parse(JSON.stringify(this.coordinates))}setProperty(e,t){this.properties[e]=t}toGeoJSON(){return JSON.parse(JSON.stringify({id:this.id,type:i.g.geojsonTypes.FEATURE,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))}internal(e){const t={id:this.id,meta:i.g.meta.FEATURE,"meta:type":this.type,active:i.g.activeStates.INACTIVE,mode:e};if(this.ctx.options.userProperties)for(const e in this.properties)t[`user_${e}`]=this.properties[e];return{type:i.g.geojsonTypes.FEATURE,properties:t,geometry:{coordinates:this.getCoordinates(),type:this.type}}}}},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var o=n(9);class r extends o.a{constructor(e,t){super(e,t),this.coordinates=this.coordinates.map(e=>e.slice(0,-1))}isValid(){return 0!==this.coordinates.length&&this.coordinates.every(e=>e.length>2)}incomingCoords(e){this.coordinates=e.map(e=>e.slice(0,-1)),this.changed()}setCoordinates(e){this.coordinates=e,this.changed()}addCoordinate(e,t,n){this.changed();const o=e.split(".").map(e=>parseInt(e,10));this.coordinates[o[0]].splice(o[1],0,[t,n])}removeCoordinate(e){this.changed();const t=e.split(".").map(e=>parseInt(e,10)),n=this.coordinates[t[0]];n&&(n.splice(t[1],1),n.length<3&&this.coordinates.splice(t[0],1))}getCoordinate(e){const t=e.split(".").map(e=>parseInt(e,10)),n=this.coordinates[t[0]];return JSON.parse(JSON.stringify(n[t[1]]))}getCoordinates(){return this.coordinates.map(e=>e.concat([e[0]]))}updateCoordinate(e,t,n){this.changed();const o=e.split("."),r=parseInt(o[0],10),i=parseInt(o[1],10);void 0===this.coordinates[r]&&(this.coordinates[r]=[]),this.coordinates[r][i]=[t,n]}}},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var o=n(9);class r extends o.a{isValid(){return this.coordinates.length>1}addCoordinate(e,t,n){this.changed();const o=parseInt(e,10);this.coordinates.splice(o,0,[t,n])}getCoordinate(e){const t=parseInt(e,10);return JSON.parse(JSON.stringify(this.coordinates[t]))}removeCoordinate(e){this.changed(),this.coordinates.splice(parseInt(e,10),1)}updateCoordinate(e,t,n){const o=parseInt(e,10);this.coordinates[o]=[t,n],this.changed()}}},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var o=n(9);class r extends o.a{isValid(){return"number"==typeof this.coordinates[0]&&"number"==typeof this.coordinates[1]}updateCoordinate(e,t,n){3===arguments.length?this.coordinates=[t,n]:this.coordinates=[e,t],this.changed()}getCoordinate(){return this.getCoordinates()}}},function(e,t,n){"use strict";n.r(t);t.default=["simple_select","direct_select","draw_point","draw_polygon","draw_line_string","draw_circle","draw_triangle","draw_rectangle","draw_sector","draw_arrow"].reduce((e,t)=>(e[t]=n(53)(`./${t}`).default,e),{})},function(e,t){var n=e.exports=function(e,t){if(t||(t=16),void 0===e&&(e=128),e<=0)return"0";for(var o=Math.log(Math.pow(2,e))/Math.log(t),r=2;o===1/0;r*=2)o=Math.log(Math.pow(2,e/r))/Math.log(t)*r;var i=o-Math.floor(o),s="";for(r=0;r<Math.floor(o);r++){s=Math.floor(Math.random()*t).toString(t)+s}if(i){var a=Math.pow(t,i);s=Math.floor(Math.random()*a).toString(t)+s}var c=parseInt(s,t);return c!==1/0&&c>=Math.pow(2,e)?n(e,t):s};n.rack=function(e,t,o){var r=function(r){var s=0;do{if(s++>10){if(!o)throw new Error("too many ID collisions, use more bits");e+=o}var a=n(e,t)}while(Object.hasOwnProperty.call(i,a));return i[a]=r,a},i=r.hats={};return r.get=function(e){return r.hats[e]},r.set=function(e,t){return r.hats[e]=t,r},r.bits=e||128,r.base=t||16,r}},function(e,t,n){"use strict";function o(e){return e*(Math.PI/180)}t.a=function(e,t,n,r){const i=o(n-e),s=o(r-t),a=Math.sin(i/2)*Math.sin(i/2)+Math.cos(o(e))*Math.cos(o(n))*Math.sin(s/2)*Math.sin(s/2);return 6371*(2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)))}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return u});var o=n(0),r=n(7),i=n(12),s=n(11),a=n(10),c=n(8);class u{constructor(e){this.map=e.map,this.drawConfig=JSON.parse(JSON.stringify(e.options||{})),this._ctx=e}setSelected(e){return this._ctx.store.setSelected(e)}setSelectedCoordinates(e){this._ctx.store.setSelectedCoordinates(e),e.reduce((e,t)=>(void 0===e[t.feature_id]&&(e[t.feature_id]=!0,this._ctx.store.get(t.feature_id).changed()),e),{})}getSelected(){return this._ctx.store.getSelected()}getSelectedIds(){return this._ctx.store.getSelectedIds()}isSelected(e){return this._ctx.store.isSelected(e)}getFeature(e){return this._ctx.store.get(e)}select(e){return this._ctx.store.select(e)}deselect(e){return this._ctx.store.deselect(e)}deleteFeature(e,t={}){return this._ctx.store.delete(e,t)}addFeature(e){return this._ctx.store.add(e)}clearSelectedFeatures(){return this._ctx.store.clearSelected()}clearSelectedCoordinates(){return this._ctx.store.clearSelectedCoordinates()}setActionableState(e={}){const t={trash:e.trash||!1,combineFeatures:e.combineFeatures||!1,uncombineFeatures:e.uncombineFeatures||!1};return this._ctx.events.actionable(t)}changeMode(e,t={},n={}){return this._ctx.events.changeMode(e,t,n)}updateUIClasses(e){return this._ctx.ui.queueMapClasses(e)}activateUIButton(e){return this._ctx.ui.setActiveButton(e)}featuresAt(e,t,n="click"){if("click"!==n&&"touch"!==n)throw new Error("invalid buffer type");return r.a[n](e,t,this._ctx)}newFeature(e){const t=e.geometry.type;return t===o.g.geojsonTypes.POINT?new i.a(this._ctx,e):t===o.g.geojsonTypes.LINE_STRING?new s.a(this._ctx,e):t===o.g.geojsonTypes.POLYGON?new a.a(this._ctx,e):new c.a(this._ctx,e)}isInstanceOf(e,t){if(e===o.g.geojsonTypes.POINT)return t instanceof i.a;if(e===o.g.geojsonTypes.LINE_STRING)return t instanceof s.a;if(e===o.g.geojsonTypes.POLYGON)return t instanceof a.a;if("MultiFeature"===e)return t instanceof c.a;throw new Error(`Unknown feature class: ${e}`)}doRender(e){return this._ctx.store.featureChanged(e)}}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var o=n(16);class r extends o.default{onSetup(){}onDrag(){}onClick(){}onMouseMove(){}onMouseDown(){}onMouseUp(){}onMouseOut(){}onKeyUp(){}onKeyDown(){}onTouchStart(){}onTouchMove(){}onTouchEnd(){}onTap(){}onStop(){}onTrash(){}onCombineFeature(){}onUncombineFeature(){}toDisplayFeatures(){throw new Error("You must overwrite toDisplayFeatures")}}},function(e,t,n){"use strict";n.r(t);var o=n(17);t.default=function(e){const t=Object.keys(e);return function(n,r={}){let i={};const s=t.reduce((t,n)=>(t[n]=e[n],t),new o.default(n));function a(e){return function(t){s[e](i,t)}}return{start:function(){i=s.onSetup(r),this.on("drag",()=>!0,a("onDrag")),this.on("click",()=>!0,a("onClick")),this.on("mousemove",()=>!0,a("onMouseMove")),this.on("mousedown",()=>!0,a("onMouseDown")),this.on("mouseup",()=>!0,a("onMouseUp")),this.on("mouseout",()=>!0,a("onMouseOut")),this.on("keyup",()=>!0,a("onKeyUp")),this.on("keydown",()=>!0,a("onKeyDown")),this.on("touchstart",()=>!0,a("onTouchStart")),this.on("touchmove",()=>!0,a("onTouchMove")),this.on("touchend",()=>!0,a("onTouchEnd")),this.on("tap",()=>!0,a("onTap"))},stop:function(){s.onStop(i)},trash:function(){s.onTrash(i)},combineFeatures:function(){s.onCombineFeatures(i)},uncombineFeatures:function(){s.onUncombineFeatures(i)},render:function(e,t){s.toDisplayFeatures(i,e,t)}}}}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var o=n(0);function r(e,t){switch(t){case"point":e.draw.changeMode(o.g.modes.DRAW_POINT);break;case"line":e.draw.changeMode(o.g.modes.DRAW_LINE_STRING);break;case"polygon":e.draw.changeMode(o.g.modes.DRAW_POLYGON);break;case"rectangle":e.draw.changeMode(o.g.modes.DRAW_RECTANGLE);break;case"triangle":e.draw.changeMode(o.g.modes.DRAW_TRIANGLE);break;case"circle":e.draw.changeMode(o.g.modes.DRAW_CIRCLE);break;case"sector":e.draw.changeMode(o.g.modes.DRAW_SECTOR);break;case"trash":e.draw.trash();break;case"combine":e.draw.combineFeatures();break;case"uncombine":e.draw.uncombineFeatures();break;case"union_polygon":e.draw.unionPolygon();break;case"split_polygon":e.draw.changeMode(o.g.modes.SPLIT_POLYGON);break;case"union_line":e.draw.unionLine();break;case"split_line":e.draw.splitLine();break;case"curve_line":e.draw.curveLine();break;case"undo":e.undoOperation();break;case"redo":e.redoOperation();break;case"static":e.draw.changeMode(o.g.modes.STATIC)}}},function(e,t,n){"use strict";var o=n(3),r=n(0),i=function(e,t,n,o){const i=t.geometry.coordinates,s=n.geometry.coordinates;if(i[1]>r.g.LAT_RENDERED_MAX||i[1]<r.g.LAT_RENDERED_MIN||s[1]>r.g.LAT_RENDERED_MAX||s[1]<r.g.LAT_RENDERED_MIN)return null;const a=o.project([i[0],i[1]]),c=o.project([s[0],s[1]]),u=o.unproject([(a.x+c.x)/2,(a.y+c.y)/2]);return{type:r.g.geojsonTypes.FEATURE,properties:{meta:r.g.meta.MIDPOINT,parent:e,lng:u.lng,lat:u.lat,coord_path:n.properties.coord_path},geometry:{type:r.g.geojsonTypes.POINT,coordinates:[u.lng,u.lat]}}};function s(e,t={},n=null){const{type:a,coordinates:c}=e.geometry,u=e.properties&&e.properties.id;let l=[];function d(e,n){let r="",s=null;e.forEach((e,a)=>{const c=void 0!==n&&null!==n?`${n}.${a}`:String(a),d=Object(o.a)(u,e,c,h(c));if(t.midpoints&&s){const e=i(u,s,d,t.map);e&&l.push(e)}s=d;const p=JSON.stringify(e);r!==p&&l.push(d),0===a&&(r=p)})}function h(e){return!!t.selectedPaths&&-1!==t.selectedPaths.indexOf(e)}return a===r.g.geojsonTypes.POINT?l.push(Object(o.a)(u,c,n,h(n))):a===r.g.geojsonTypes.POLYGON?c.forEach((e,t)=>{d(e,null!==n?`${n}.${t}`:String(t))}):a===r.g.geojsonTypes.LINE_STRING?d(c,n):0===a.indexOf(r.g.geojsonTypes.MULTI_PREFIX)&&function(){const n=a.replace(r.g.geojsonTypes.MULTI_PREFIX,"");c.forEach((o,i)=>{const a={type:r.g.geojsonTypes.FEATURE,properties:e.properties,geometry:{type:n,coordinates:o}};l=l.concat(s(a,t,i))})}(),l}n.d(t,"a",function(){return s})},function(e,t,n){"use strict";var o=n(22),r=n(0);t.a=function(e,t){const n=Object(o.a)(e.map(e=>e.toGeoJSON()),t);e.forEach(e=>{const t=e.getCoordinates(),o=e=>{const t={lng:e[0]+n.lng,lat:e[1]+n.lat};return[t.lng,t.lat]},i=e=>e.map(e=>o(e)),s=e=>e.map(e=>i(e));let a;e.type===r.g.geojsonTypes.POINT?a=o(t):e.type===r.g.geojsonTypes.LINE_STRING||e.type===r.g.geojsonTypes.MULTI_POINT?a=t.map(o):e.type===r.g.geojsonTypes.POLYGON||e.type===r.g.geojsonTypes.MULTI_LINE_STRING?a=t.map(i):e.type===r.g.geojsonTypes.MULTI_POLYGON&&(a=t.map(s)),e.incomingCoords(a)})}},function(e,t,n){"use strict";var o=n(39),r=n.n(o),i=n(0);t.a=function(e,t){let n=i.LAT_MIN,o=i.LAT_MAX,s=i.LAT_MIN,a=i.LAT_MAX,c=i.LNG_MAX,u=i.LNG_MIN;e.forEach(e=>{const t=r()(e),i=t[1],l=t[3],d=t[0],h=t[2];i>n&&(n=i),l<o&&(o=l),l>s&&(s=l),i<a&&(a=i),d<c&&(c=d),h>u&&(u=h)});const l=t;return n+l.lat>i.LAT_RENDERED_MAX&&(l.lat=i.LAT_RENDERED_MAX-n),s+l.lat>i.LAT_MAX&&(l.lat=i.LAT_MAX-s),o+l.lat<i.LAT_RENDERED_MIN&&(l.lat=i.LAT_RENDERED_MIN-o),a+l.lat<i.LAT_MIN&&(l.lat=i.LAT_MIN-a),c+l.lng<=i.LNG_MIN&&(l.lng+=360*Math.ceil(Math.abs(l.lng)/360)),u+l.lng>=i.LNG_MAX&&(l.lng-=360*Math.ceil(Math.abs(l.lng)/360)),l}},function(e,t){e.exports=function(e){if(!e||!e.type)return null;var t=n[e.type];if(!t)return null;if("geometry"===t)return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:e}]};if("feature"===t)return{type:"FeatureCollection",features:[e]};if("featurecollection"===t)return e};var n={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"}},function(e,t,n){"use strict";n.r(t);var o=n(1),r=n(2),i=n(0),s=(n(4),n(3),n(15)),a=function(e,t){const n=Math.floor(60),o=t/6250,r=e[1]*Math.PI/180,i=e[0]*Math.PI/180,s=[];for(let e=0;e<n;e++){const t=6*e*Math.PI/180,n=Math.asin(Math.sin(r)*Math.cos(o)+Math.cos(r)*Math.sin(o)*Math.cos(t)),a=i+Math.atan2(Math.sin(t)*Math.sin(o)*Math.cos(r),Math.cos(o)-Math.sin(r)*Math.sin(n)),c=180*n/Math.PI,u=[180*a/Math.PI,c];s.push(u)}return s.push(s[0]),s};const c={onSetup:function(e){let t=this.newFeature({type:i.g.geojsonTypes.FEATURE,properties:{_type_:i.g.geojsonTypes.CIRCLE},geometry:{type:i.g.geojsonTypes.POLYGON,coordinates:[[]]}});return this.addFeature(t),this.clearSelectedFeatures(),r.a.disable(this),this.updateUIClasses({mouse:i.g.cursors.ADD}),this.activateUIButton(i.g.types.CIRCLE),this.setActionableState({trash:!0}),{circle:t,currentVertexPosition:0}},onMouseMove:function(e,t){let{currentVertexPosition:n,circle:r}=e;if(0===n)return;const c=Object(s.a)(r.center[1],r.center[0],t.lngLat.lat,t.lngLat.lng),u=a(r.center,c);r.setCoordinates([u]),n=u.length,o.a.isVertex(t)&&this.updateUIClasses({mouse:i.g.cursors.POINTER}),e=Object.assign(e,{currentVertexPosition:n,circle:r})},onClick:function(e,t){let{circle:n,currentVertexPosition:r}=e;if(r>0)return this.changeMode(i.g.modes.SIMPLE_SELECT,{featureIds:[n.id]});o.a.isVertex(t)&&this.changeMode(i.g.modes.SIMPLE_SELECT,{featureIds:[n.id]}),this.updateUIClasses({mouse:i.g.cursors.ADD}),n.center=[t.lngLat.lng,t.lngLat.lat];const s=a([t.lngLat.lng,t.lngLat.lat],0);n.setCoordinates([s]),r=s.length,e=Object.assign(e,{currentVertexPosition:r,circle:n})},onKeyUp:function(e,t){let{circle:n,currentVertexPosition:r}=e;o.a.isEscapeKey&&(this.deleteFeature(n.id,{silent:!0}),this.changeMode(i.g.modes.SIMPLE_SELECT)),o.a.isEnterKey&&this.changeMode(i.g.modes.SIMPLE_SELECT,{featureIds:[n.id]})},onStop:function(e){let{circle:t,currentVertexPosition:n}=e;this.updateUIClasses({mouse:i.g.cursors.NONE}),r.a.enable(this),this.activateUIButton(),void 0!==this.getFeature(t.id)&&(t.removeCoordinate(`0.${n}`),t.isValid()?this.map.fire(i.g.events.CREATE,{features:[t.toGeoJSON()]}):(this.deleteFeature([t.id],{silent:!0}),this.changeMode(i.g.modes.SIMPLE_SELECT,{},{silent:!0})))},toDisplayFeatures:function(e,t,n){let{circle:o,currentVertexPosition:r}=e;const s=t.properties.id===o.id;o.properties.class;if(t.properties.active=s?i.g.activeStates.ACTIVE:i.g.activeStates.INACTIVE,!s)return n(t);if(0===t.geometry.coordinates.length)return;const a=t.geometry.coordinates[0].length;return a<3?void 0:(t.properties.meta=i.g.meta.FEATURE,a>3?n(t):void 0)},onTrash:function(e){let{circle:t,currentVertexPosition:n}=e;this.deleteFeature([t.id],{silent:!0}),this.changeMode(i.g.modes.SIMPLE_SELECT)}};t.default=c},function(e,t,n){"use strict";n.r(t);var o=n(1),r=n(2),i=n(0),s=(n(4),n(3)),a=function(e,t){let n=[];const o=[],r=[],i=[],s=[],a=e[0]<=t[0]?e[0]:t[0],c=e[1]<=t[1]?e[1]:t[1],u=e[0]>=t[0]?e[0]:t[0],l=e[1]>=t[1]?e[1]:t[1],d=u,h=c,p=a,g=l;return o.push(a,c),r.push(p,g),i.push(d,h),s.push(u,l),n=[].concat([r,o,i,s,r])};const c={onSetup:function(e){let t=this.newFeature({type:i.g.geojsonTypes.FEATURE,properties:{_type_:i.g.geojsonTypes.RECTANGLE},geometry:{type:i.g.geojsonTypes.POLYGON,coordinates:[[]]}});return this.addFeature(t),this.clearSelectedFeatures(),r.a.disable(this),this.updateUIClasses({mouse:i.g.cursors.ADD}),this.activateUIButton(i.g.types.RECTANGLE),this.setActionableState({trash:!0}),{rectangle:t,currentVertexPosition:0}},onClick:function(e,t){let{rectangle:n,currentVertexPosition:r}=e;if(r>0)return this.changeMode(i.g.modes.SIMPLE_SELECT,{featureIds:[n.id]});o.a.isVertex(t)&&this.changeMode(i.g.modes.SIMPLE_SELECT,{featureIds:[n.id]}),this.updateUIClasses({mouse:i.g.cursors.ADD}),n.ltPoint=[t.lngLat.lng,t.lngLat.lat];const s=a(n.ltPoint,n.ltPoint);n.setCoordinates([s]),r=s.length,e=Object.assign(e,{rectangle:n,currentVertexPosition:r})},onMouseMove:function(e,t){let{rectangle:n,currentVertexPosition:r}=e;if(0===r)return;const s=[t.lngLat.lng,t.lngLat.lat];n.rbPoint=s;const c=a(n.ltPoint,s);n.setCoordinates([c]),r=c.length,o.a.isVertex(t)&&this.updateUIClasses({mouse:i.g.cursors.POINTER}),e=Object.assign(e,{currentVertexPosition:r,rectangle:n})},onStop:function(e){let{rectangle:t,currentVertexPosition:n}=e;this.updateUIClasses({mouse:i.g.cursors.NONE}),r.a.enable(this),this.activateUIButton(),void 0!==this.getFeature(t.id)&&(t.removeCoordinate(`0.${n}`),t.isValid()?this.map.fire(i.g.events.CREATE,{features:[t.toGeoJSON()]}):(this.deleteFeature([t.id],{silent:!0}),this.changeMode(i.g.modes.SIMPLE_SELECT,{},{silent:!0})))},toDisplayFeatures:function(e,t,n){let{rectangle:o,currentVertexPosition:r}=e;const a=t.properties.id===o.id;o.properties.class;if(t.properties.active=a?i.g.activeStates.ACTIVE:i.g.activeStates.INACTIVE,!a)return n(t);if(0===t.geometry.coordinates.length)return;const c=t.geometry.coordinates[0].length;if(!(c<4)){if(t.properties.meta=i.g.meta.FEATURE,n(Object(s.a)(o.id,t.geometry.coordinates[0][0],"0.0",!1)),c>5){const e=t.geometry.coordinates[0].length-4;n(Object(s.a)(o.id,t.geometry.coordinates[0][e],`0.${e}`,!1))}return n(t)}}};t.default=c},function(e,t,n){"use strict";n.r(t);var o=n(1),r=n(2),i=n(0);n(4),n(3);const s=5,a=11,c=18;const u={};let l={x:0,y:0};u.onSetup=function(){const e=this.newFeature({type:i.g.geojsonTypes.FEATURE,properties:{_type_:i.g.geojsonTypes.ARROW},geometry:{type:i.g.geojsonTypes.POLYGON,coordinates:[[]]}});return this.addFeature(e),this.clearSelectedFeatures(),r.a.disable(this),this.updateUIClasses({mouse:i.g.cursors.ADD}),this.activateUIButton(i.g.types.ARROW),this.setActionableState({trash:!0}),{arrow:e,currentClickNum:0}},u.onMouseMove=function(e,t){let{arrow:n,currentClickNum:r}=e;if(1===r){const e=function(e,t,n){const o=[];o[0]=[t.x,t.y],o[3]=[n.x,n.y];const r=Math.sqrt((t.x-n.x)*(t.x-n.x)+(t.y-n.y)*(t.y-n.y));if(0===r)return;const i=-(n.x-t.x)/r,u=(n.y-t.y)/r,l=(Math.sqrt(s*s+(r-c)*(r-c)),Math.sqrt(a*a+(r-c)*(r-c)),t.x+s),d=t.y+r-c,h=t.x+a,p=t.y+r-c,g=t.x-s,f=t.y+r-c,y=t.x-a,m=t.y+r-c;o[1]=[t.x+(l-t.x)*u-(d-t.y)*i,t.y+(l-t.x)*i+(d-t.y)*u],o[2]=[t.x+(h-t.x)*u-(p-t.y)*i,t.y+(h-t.x)*i+(p-t.y)*u],o[4]=[t.x+(y-t.x)*u-(m-t.y)*i,t.y+(y-t.x)*i+(m-t.y)*u],o[5]=[t.x+(g-t.x)*u-(f-t.y)*i,t.y+(g-t.x)*i+(f-t.y)*u],o[6]=o[0];for(let t=0;t<o.length;t++){const n=e.map.unproject(o[t]);o[t]=[n.lng,n.lat]}return o}(this,l,this.map.project(t.lngLat));e&&n.setCoordinates([e])}else 2===r&&(this.map.fire(i.g.events.CREATE,{features:[n.toGeoJSON()]}),this.changeMode(i.g.modes.SIMPLE_SELECT,{featureIds:[n.id]}));o.a.isVertex(t)&&this.updateUIClasses({mouse:i.g.cursors.POINTER}),e=Object.assign(e,{currentClickNum:r,arrow:n})},u.onClick=function(e,t){let{arrow:n,currentClickNum:r}=e;this.updateUIClasses({mouse:i.g.cursors.ADD}),0===r?(l=this.map.project(t.lngLat),r++):1===r&&r++,o.a.isVertex(t)&&this.changeMode(i.g.modes.SIMPLE_SELECT,{featureIds:[n.id]}),e=Object.assign(e,{currentClickNum:r,arrow:n})},u.onKeyUp=function(e,t){let{arrow:n,currentClickNum:r}=e;o.a.isEscapeKey&&(this.deleteFeature([n.id],{silent:!0}),this.changeMode(i.g.modes.SIMPLE_SELECT)),o.a.isEnterKey&&this.changeMode(i.g.modes.SIMPLE_SELECT,{featureIds:[n.id]})},u.onStop=function(e,t){let{arrow:n,currentClickNum:o}=e;this.updateUIClasses({mouse:i.g.cursors.NONE}),(!this.map||this.map.doubleClickZoom.isEnabled())&&r.a.enable(this),this.activateUIButton(),void 0!==this.getFeature(n.id)&&(n.isValid()?this.map.fire(i.g.events.CREATE,{features:[n.toGeoJSON()]}):(this.deleteFeature([n.id],{silent:!0}),this.changeMode(i.g.modes.SIMPLE_SELECT,{},{silent:!0})))},u.toDisplayFeatures=function(e,t,n){let{arrow:o,currentClickNum:r}=e;const s=t.properties.id===o.id;if(t.properties.active=s?i.g.activeStates.ACTIVE:i.g.activeStates.INACTIVE,!s)return n(t);if(0===t.geometry.coordinates.length)return;const a=t.geometry.coordinates[0].length;if(a<3)return;if(t.properties.meta=i.g.meta.FEATURE,a>3)return n(t);const c=[[t.geometry.coordinates[0][0][0],t.geometry.coordinates[0][0][1]],[t.geometry.coordinates[0][1][0],t.geometry.coordinates[0][1][1]]];return n({type:i.g.geojsonTypes.FEATURE,properties:t.properties,geometry:{coordinates:c,type:i.g.geojsonTypes.LINE_STRING}})},u.onTrash=function(e){let{arrow:t,currentClickNum:n}=e;this.deleteFeature([t.id],{silent:!0}),this.changeMode(i.g.modes.SIMPLE_SELECT)};t.default=u},function(e,t,n){"use strict";n.r(t);var o=n(1),r=n(38),i=n.n(r);function s(e,t){const n=t.getBoundingClientRect();return new i.a(e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0))}var a=n(20),c=n(6),u=n(2),l=n(21),d=n(0);const h={onSetup:function(e){const t={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoveing:!1,canDragMove:!1,initiallySelectedFeatureIds:e.featureIds||[]};return this.setSelected(t.initiallySelectedFeatureIds.filter(e=>void 0!==this.getFeature(e))),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),t},fireUpdate:function(){this.map.fire(d.g.events.UPDATE,{action:d.g.updateActions.MOVE,features:this.getSelected().map(e=>e.toGeoJSON())})},fireActionable:function(){const e=this.getSelected(),t=e.filter(e=>this.isInstanceOf("MultiFeature",e));let n=!1;if(e.length>1){n=!0;const t=e[0].type.replace("Multi","");e.forEach(e=>{e.type.replace("Multi","")!==t&&(n=!1)})}const o=t.length>0,r=e.length>0;this.setActionableState({combineFeatures:n,uncombineFeatures:o,trash:r})},getUniqueIds:function(e){if(!e.length)return[];return e.map(e=>e.properties.id).filter(e=>void 0!==e).reduce((e,t)=>(e.add(t),e),new c.a).values()},stopExtendedInteractions:function(e){e.boxSelectElement&&(e.boxSelectElement.parentNode&&e.boxSelectElement.parentNode.removeChild(e.boxSelectElement),e.boxSelectElement=null),this.map.dragPan.enable(),e.boxSelecting=!1,e.canBoxSelect=!1,e.dragMoving=!1,e.canDragMove=!1},onStop:function(){u.a.enable(this)},onMouseUp:function(e,t){if(o.a.true(t))return this.stopExtendedInteractions(e)},onMouseMove:function(e){return this.stopExtendedInteractions(e)},onMouseOut:function(e){if(e.dragMoving)return this.fireUpdate()}};h.onTap=h.onClick=function(e,t){return o.a.noTarget(t)?this.clickAnywhere(e,t):o.a.isOfMetaType(d.g.meta.VERTEX)(t)?this.clickOnVertex(e,t):o.a.isFeature(t)?this.clickOnFeature(e,t):void 0},h.clickAnywhere=function(e){const t=this.getSelectedIds();t.length&&(this.clearSelectedFeatures(),t.forEach(e=>this.doRender(e))),u.a.enable(this),this.stopExtendedInteractions(e)},h.clickOnVertex=function(e,t){console.log(t.featureTarget.layer.type),this.changeMode(d.g.modes.DIRECT_SELECT,{featureId:t.featureTarget.properties.parent,coordPath:t.featureTarget.properties.coord_path,startPos:t.lngLat}),this.updateUIClasses({mouse:d.g.cursors.MOVE})},h.startOnActiveFeature=function(e,t){this.stopExtendedInteractions(e),this.map.dragPan.disable(),this.doRender(t.featureTarget.properties.id),e.canDragMove=!0,e.dragMoveLocation=t.lngLat},h.clickOnFeature=function(e,t){u.a.disable(this),this.stopExtendedInteractions(e);const n=o.a.isShiftDown(t),r=this.getSelectedIds(),i=t.featureTarget.properties.id,s=this.isSelected(i);if(!n&&s&&this.getFeature(i).type!==d.g.geojsonTypes.POINT)return this.changeMode(d.g.modes.DIRECT_SELECT,{featureId:i});s&&n?(this.deselect(i),this.updateUIClasses({mouse:d.g.cursors.POINTER}),1===r.length&&u.a.enable(this)):!s&&n?(this.select(i),this.updateUIClasses({mouse:d.g.cursors.MOVE})):s||n||(r.forEach(e=>this.doRender(e)),this.setSelected(i),this.updateUIClasses({mouse:d.g.cursors.MOVE})),this.doRender(i)},h.onMouseDown=function(e,t){return o.a.isActiveFeature(t)?this.startOnActiveFeature(e,t):this.drawConfig.boxSelect&&o.a.isShiftMousedown(t)?this.startBoxSelect(e,t):void 0},h.startBoxSelect=function(e,t){this.stopExtendedInteractions(e),this.map.dragPan.disable(),e.boxSelectStartLocation=s(t.originalEvent,this.map.getContainer()),e.canBoxSelect=!0},h.onTouchStart=function(e,t){if(o.a.isActiveFeature(t))return this.startOnActiveFeature(e,t)},h.onDrag=function(e,t){return e.canDragMove?this.dragMove(e,t):this.drawConfig.boxSelect&&e.canBoxSelect?this.whileBoxSelect(e,t):void 0},h.whileBoxSelect=function(e,t){e.boxSelecting=!0,this.updateUIClasses({mouse:d.g.cursors.ADD}),e.boxSelectElement||(e.boxSelectElement=document.createElement("div"),e.boxSelectElement.classList.add(d.g.classes.BOX_SELECT),this.map.getContainer().appendChild(e.boxSelectElement));const n=s(t.originalEvent,this.map.getContainer()),o=Math.min(e.boxSelectStartLocation.x,n.x),r=Math.max(e.boxSelectStartLocation.x,n.x),i=Math.min(e.boxSelectStartLocation.y,n.y),a=Math.max(e.boxSelectStartLocation.y,n.y),c=`translate(${o}px, ${i}px)`;e.boxSelectElement.style.transform=c,e.boxSelectElement.style.WebkitTransform=c,e.boxSelectElement.style.width=`${r-o}px`,e.boxSelectElement.style.height=`${a-i}px`},h.dragMove=function(e,t){e.dragMoving=!0,t.originalEvent.stopPropagation();const n={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};Object(l.a)(this.getSelected(),n),e.dragMoveLocation=t.lngLat},h.onMouseUp=function(e,t){if(e.dragMoving)this.fireUpdate();else if(e.boxSelecting){const n=[e.boxSelectStartLocation,s(t.originalEvent,this.map.getContainer())],o=this.featuresAt(null,n,"click"),r=this.getUniqueIds(o).filter(e=>!this.isSelected(e));r.length&&(this.select(r),r.forEach(e=>this.doRender(e)),this.updateUIClasses({mouse:d.g.cursors.MOVE}))}this.stopExtendedInteractions(e)},h.toDisplayFeatures=function(e,t,n){t.properties.active=this.isSelected(t.properties.id)?d.g.activeStates.ACTIVE:d.g.activeStates.INACTIVE,n(t),this.fireActionable(),t.properties.active===d.g.activeStates.ACTIVE&&t.geometry.type!==d.g.geojsonTypes.POINT&&Object(a.a)(t).forEach(n)},h.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()},h.onCombineFeatures=function(){const e=this.getSelected();if(0===e.length||e.length<2)return;const t=[],n=[],o=e[0].type.replace("Multi","");for(let r=0;r<e.length;r++){const i=e[r];if(i.type.replace("Multi","")!==o)return;i.type.includes("Multi")?i.getCoordinates().forEach(e=>{t.push(e)}):t.push(i.getCoordinates()),n.push(i.toGeoJSON())}if(n.length>1){const e=this.newFeature({type:d.g.geojsonTypes.FEATURE,properties:n[0].properties,geometry:{type:`Multi${o}`,coordinates:t}});this.addFeature(e),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([e.id]),this.map.fire(d.g.events.COMBINE_FEATURES,{createdFeatures:[e.toGeoJSON()],deletedFeatures:n})}this.fireActionable()},h.onUncombineFeatures=function(){const e=this.getSelected();if(0===e.length)return;const t=[],n=[];for(let o=0;o<e.length;o++){const r=e[o];this.isInstanceOf("MultiFeature",r)&&(r.getFeatures().forEach(e=>{this.addFeature(e),e.properties=r.properties,t.push(e.toGeoJSON()),this.select([e.id])}),this.deleteFeature(r.id,{silent:!0}),n.push(r.toGeoJSON()))}t.length>1&&this.map.fire(d.g.events.UNCOMBINE_FEATURES,{createdFeatures:t,deletedFeatures:n}),this.fireActionable()};t.default=h},function(e,t,n){"use strict";n.r(t);var o=n(1),r=n(2),i=n(0),s=(n(4),n(3)),a=n(15),c=function(e,t,n,o,r,i){const s=Math.sqrt(Math.pow(e-n,2)+Math.pow(t-o,2)),a=Math.sqrt(Math.pow(e-r,2)+Math.pow(t-i,2)),c=Math.sqrt(Math.pow(n-r,2)+Math.pow(o-i,2));if(0===s||0===a||0===c)return 0;const u=(Math.pow(s,2)+Math.pow(a,2)-Math.pow(c,2))/(2*s*a);return Math.acos(u)};const u={onSetup:function(e){let t=this.newFeature({type:i.g.geojsonTypes.FEATURE,properties:{_type_:i.g.geojsonTypes.SECTOR},geometry:{type:i.g.geojsonTypes.POLYGON,coordinates:[[]]}});return this.addFeature(t),this.clearSelectedFeatures(),r.a.disable(this),this.updateUIClasses({mouse:i.g.cursors.ADD}),this.activateUIButton(i.g.types.SECTOR),this.setActionableState({trash:!0}),{sector:t,currentVertexPosition:0}},onClick:function(e,t){let{sector:n,currentVertexPosition:r}=e;if(r>1&&this.changeMode(i.g.modes.SIMPLE_SELECT,{featureIds:[n.id]}),o.a.isVertex(t)&&this.changeMode(i.g.modes.SIMPLE_SELECT,{featureIds:[n.id]}),this.updateUIClasses({mouse:i.g.cursors.ADD}),r<1)n.center=[t.lngLat.lng,t.lngLat.lat],n.arcPoint=[t.lngLat.lng,t.lngLat.lat];else{n.arcPoint=[t.lngLat.lng,t.lngLat.lat];const e=Object(a.a)(n.center[1],n.center[0],n.arcPoint[1],n.arcPoint[0]);n.radius=e;let o=c(n.center[0],n.center[1],n.center[0],0,n.arcPoint[0],n.arcPoint[1]);n.arcPoint[0]-n.center[0]>0?(o=Math.PI-o,o=Math.round(180*o/Math.PI)):(o-=Math.PI,o=Math.round(180*o/Math.PI)),n.offset=o}r++,e=Object.assign(e,{currentVertexPosition:r,sector:n})}};u.onMouseMove=function(e,t){let{sector:n,currentVertexPosition:r}=e,{center:s,arcPoint:u,radius:l}=n;if(0!==r){if(1===r){l=Object(a.a)(s[1],s[0],t.lngLat.lat,t.lngLat.lng),n.radius=l;const e=[s,[t.lngLat.lng,t.lngLat.lat]];n.setCoordinates([e])}else{let e=c(s[0],s[1],u[0],u[1],t.lngLat.lng,t.lngLat.lat);const o=(d=s[0],h=s[1],p=u[0],g=u[1],f=t.lngLat.lng,y=t.lngLat.lat,(g-h)*f+(d-p)*y+(p*h-d*g));n.isSmallerSide=+o>0;let r=n.offset;n.isSmallerSide||(e=2*Math.PI-e);const i=function(e,t,n,o,r){const i=n/(2*Math.PI),s=Math.floor(360*i/6),a=o/6,c=t/6250,u=e[1]*Math.PI/180,l=e[0]*Math.PI/180,d=[];d.push(e),d.push(r);for(let e=0;e<s;e++){const t=6*(e+a)*Math.PI/180,n=Math.asin(Math.sin(u)*Math.cos(c)+Math.cos(u)*Math.sin(c)*Math.cos(t)),o=l+Math.atan2(Math.sin(t)*Math.sin(c)*Math.cos(u),Math.cos(c)-Math.sin(u)*Math.sin(n)),r=180*n/Math.PI,i=[180*o/Math.PI,r];d.push(i)}return d.push(e),d}(s,l,e,r,u);n.radian=e,n.setCoordinates([i])}var d,h,p,g,f,y;o.a.isVertex(t)&&this.updateUIClasses({mouse:i.g.cursors.POINTER}),e=Object.assign(e,{sector:n,currentVertexPosition:r})}},u.onStop=function(e){let{sector:t,currentVertexPosition:n}=e;this.updateUIClasses({mouse:i.g.cursors.NONE}),r.a.enable(this),this.activateUIButton(),void 0!==this.getFeature(t.id)&&(t.removeCoordinate(`0.${n}`),t.isValid()?this.map.fire(i.g.events.CREATE,{features:[t.toGeoJSON]}):(this.deleteFeature([t.id],{slient:!0}),this.changeMode(i.g.modes.SIMPLE_SELECT,{},{slient:!0})))},u.toDisplayFeatures=function(e,t,n){let{sector:o,currentVertexPosition:r}=e;const a=t.properties.id===o.id;o.properties.class;if(t.properties.active=a?i.g.activeStates.ACTIVE:i.g.activeStates.INACTIVE,!a)return n(t);if(0===t.geometry.coordinates.length)return;const c=t.geometry.coordinates[0].length;if(!(c<3)){if(n(Object(s.a)(o.id,t.geometry.coordinates[0][0],"0.0",!1)),2===r&&n(Object(s.a)(o.id,t.geometry.coordinates[0][1],"0.1",!1)),c<=4){const e=[[t.geometry.coordinates[0][0][0],t.geometry.coordinates[0][0][1]],[t.geometry.coordinates[0][1][0],t.geometry.coordinates[0][1][1]]];n({type:i.g.geojsonTypes.FEATURE,properties:t.properties,geometry:{coordinates:e,type:i.g.geojsonTypes.LINE_STRING}})}return t.properties.meta=i.g.meta.FEATURE,c>4?n(t):void 0}},u.onTrash=function(e){let{sector:t,currentVertexPosition:n}=e;this.deleteFeature([t.id],{silent:!0}),this.changeMode(i.g.modes.SIMPLE_SELECT)};t.default=u},function(e,t){var n,o,r=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{o="function"==typeof clearTimeout?clearTimeout:s}catch(e){o=s}}();var c,u=[],l=!1,d=-1;function h(){l&&c&&(l=!1,c.length?u=c.concat(u):d=-1,u.length&&p())}function p(){if(!l){var e=a(h);l=!0;for(var t=u.length;t;){for(c=u,u=[];++d<t;)c&&c[d].run();d=-1,t=u.length}c=null,l=!1,function(e){if(o===clearTimeout)return clearTimeout(e);if((o===s||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{o(e)}catch(t){try{return o.call(null,e)}catch(t){return o.call(this,e)}}}(e)}}function g(e,t){this.fun=e,this.array=t}function f(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new g(e,t)),1!==u.length||l||a(p)},g.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=f,r.addListener=f,r.once=f,r.off=f,r.removeListener=f,r.removeAllListeners=f,r.emit=f,r.prependListener=f,r.prependOnceListener=f,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){"use strict";n.r(t);var o=n(1),r=n(2),i=n(0),s=n(4),a=n(3);const c={onSetup:function(){const e=this.newFeature({type:i.g.geojsonTypes.FEATURE,properties:{_type_:i.g.geojsonTypes.TRIANGLE},geometry:{type:i.g.geojsonTypes.POLYGON,coordinates:[[]]}});return this.addFeature(e),this.clearSelectedFeatures(),r.a.disable(this),this.updateUIClasses({mouse:i.g.cursors.ADD}),this.activateUIButton(i.g.types.TRIANGLE),this.setActionableState({trash:!0}),{triangle:e,currentVertexPosition:0}},clickAnywhere:function(e,t){let{triangle:n,currentVertexPosition:o}=e;return o>0&&Object(s.a)(t,n.coordinates[0][o-1])?this.changeMode(i.g.modes.SIMPLE_SELECT,{featureIds:[n.id]}):(this.updateUIClasses({mouse:i.g.cursors.ADD}),n.updateCoordinate(`0.${o}`,t.lngLat.lng,t.lngLat.lat),o++,n.updateCoordinate(`0.${o}`,t.lngLat.lng,t.lngLat.lat),e=Object.assign(e,{triangle:n,currentVertexPosition:o}),o>=3?this.changeMode(i.g.modes.SIMPLE_SELECT,{featureIds:[n.id]}):void 0)},clickOnVertex:function(e,t){let{triangle:n,currentVertexPosition:o}=e;return this.changeMode(i.g.modes.SIMPLE_SELECT,{featureIds:[n.id]})}};c.onTap=c.onClick=function(e,t){return o.a.isVertex(t)?this.clickOnVertex(e,t):this.clickAnywhere(e,t)},c.onKeyUp=function(e,t){let{triangle:n,currentVertexPosition:r}=e;o.a.isEscapeKey(t)?(this.deleteFeature([n.id],{slient:!0}),this.changeMode(i.g.modes.SIMPLE_SELECT)):o.a.isEnterKey(t)&&this.changeMode(i.g.modes.SIMPLE_SELECT,{featureIds:[n.id]})},c.onMouseMove=function(e,t){let{triangle:n,currentVertexPosition:r}=e;n.updateCoordinate(`0.${r}`,t.lngLat.lng,t.lngLat.lat),o.a.isVertex(t)&&this.updateUIClasses({mouse:i.g.cursors.POINTER})},c.onStop=function(e){let{triangle:t,currentVertexPosition:n}=e;this.updateUIClasses({mouse:i.g.cursors.NONE}),r.a.enable(this),this.activateUIButton(),void 0!==this.getFeature(t.id)&&(t.removeCoordinate(`0.${n}`),t.isValid()?this.map.fire(i.g.events.CREATE,{features:[t.toGeoJSON()]}):(this.deleteFeature([t.id],{slient:!0}),this.changeMode(i.g.modes.SIMPLE_SELECT,{},{slient:!0})))},c.toDisplayFeatures=function(e,t,n){let{triangle:o,currentVertexPosition:r}=e;const s=t.properties.id===o.id;if(t.properties.active=s?i.g.activeStates.ACTIVE:i.g.activeStates.INACTIVE,!s)return n(t);if(0===t.geometry.coordinates.length)return;const c=t.geometry.coordinates[0].length;if(!(c<3)){if(t.properties.meta=i.g.meta.FEATURE,n(Object(a.a)(o.id,t.geometry.coordinates[0][0],"0.0",!1)),c>3){const e=t.geometry.coordinates[0].length-3;n(Object(a.a)(o.id,t.geometry.coordinates[0][e],`0.${e}`,!1))}if(c<=4){const e=[[t.geometry.coordinates[0][0][0],t.geometry.coordinates[0][0][1]],[t.geometry.coordinates[0][1][0],t.geometry.coordinates[0][1][1]]];if(n({type:i.g.geojsonTypes.FEATURE,properties:t.properties,geometry:{coordinates:e,type:i.g.geojsonTypes.LINE_STRING}}),3===c)return}return n(t)}},c.onTrash=function(e){let{triangle:t,currentVertexPosition:n}=e;this.deleteFeature([t.id],{slient:!0}),this.changeMode(i.g.modes.SIMPLE_SELECT)},t.default=c},function(e,t,n){"use strict";n.r(t);var o=n(1),r=n(2),i=n(0),s=n(4),a=n(3);const c={onSetup:function(){const e=this.newFeature({type:i.g.geojsonTypes.FEATURE,properties:{_type_:i.g.geojsonTypes.POLYGON},geometry:{type:i.g.geojsonTypes.POLYGON,coordinates:[[]]}});return this.addFeature(e),this.clearSelectedFeatures(),r.a.disable(this),this.updateUIClasses({mouse:i.g.cursors.ADD}),this.activateUIButton(i.g.types.POLYGON),this.setActionableState({trash:!0}),{polygon:e,currentVertexPosition:0}},clickAnywhere:function(e,t){if(e.currentVertexPosition>0&&Object(s.a)(t,e.polygon.coordinates[0][e.currentVertexPosition-1]))return this.changeMode(i.g.modes.SIMPLE_SELECT,{featureIds:[e.polygon.id]});this.updateUIClasses({mouse:i.g.cursors.ADD}),e.polygon.updateCoordinate(`0.${e.currentVertexPosition}`,t.lngLat.lng,t.lngLat.lat),e.currentVertexPosition++,e.polygon.updateCoordinate(`0.${e.currentVertexPosition}`,t.lngLat.lng,t.lngLat.lat)},clickOnVertex:function(e){return this.changeMode(i.g.modes.SIMPLE_SELECT,{featureIds:[e.polygon.id]})},onMouseMove:function(e,t){e.polygon.updateCoordinate(`0.${e.currentVertexPosition}`,t.lngLat.lng,t.lngLat.lat),o.a.isVertex(t)&&this.updateUIClasses({mouse:i.g.cursors.POINTER})}};c.onTap=c.onClick=function(e,t){return o.a.isVertex(t)?this.clickOnVertex(e,t):this.clickAnywhere(e,t)},c.onKeyUp=function(e,t){o.a.isEscapeKey(t)?(this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(i.g.modes.SIMPLE_SELECT)):o.a.isEnterKey(t)&&this.changeMode(i.g.modes.SIMPLE_SELECT,{featureIds:[e.polygon.id]})},c.onStop=function(e){this.updateUIClasses({mouse:i.g.cursors.NONE}),r.a.enable(this),this.activateUIButton(),void 0!==this.getFeature(e.polygon.id)&&(e.polygon.removeCoordinate(`0.${e.currentVertexPosition}`),e.polygon.isValid()?this.map.fire(i.g.events.CREATE,{features:[e.polygon.toGeoJSON()]}):(this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(i.g.modes.SIMPLE_SELECT,{},{silent:!0})))},c.toDisplayFeatures=function(e,t,n){const o=t.properties.id===e.polygon.id;if(t.properties.active=o?i.g.activeStates.ACTIVE:i.g.activeStates.INACTIVE,!o)return n(t);if(0===t.geometry.coordinates.length)return;const r=t.geometry.coordinates[0].length;if(!(r<3)){if(t.properties.meta=i.g.meta.FEATURE,n(Object(a.a)(e.polygon.id,t.geometry.coordinates[0][0],"0.0",!1)),r>3){const o=t.geometry.coordinates[0].length-3;n(Object(a.a)(e.polygon.id,t.geometry.coordinates[0][o],`0.${o}`,!1))}if(r<=4){const e=[[t.geometry.coordinates[0][0][0],t.geometry.coordinates[0][0][1]],[t.geometry.coordinates[0][1][0],t.geometry.coordinates[0][1][1]]];if(n({type:i.g.geojsonTypes.FEATURE,properties:t.properties,geometry:{coordinates:e,type:i.g.geojsonTypes.LINE_STRING}}),3===r)return}return n(t)}},c.onTrash=function(e){this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(i.g.modes.SIMPLE_SELECT)},t.default=c},function(e,t,n){"use strict";n.r(t);var o=n(1),r=n(0);const i={onSetup:function(){const e=this.newFeature({type:r.g.geojsonTypes.FEATURE,properties:{_type_:r.g.geojsonTypes.POINT},geometry:{type:r.g.geojsonTypes.POINT,coordinates:[]}});return this.addFeature(e),this.clearSelectedFeatures(),this.updateUIClasses({mouse:r.g.cursors.ADD}),this.activateUIButton(r.g.types.POINT),this.setActionableState({trash:!0}),{point:e}},stopDrawingAndRemove:function(e){this.deleteFeature([e.point.id],{silent:!0}),this.changeMode(r.g.modes.SIMPLE_SELECT)}};i.onTap=i.onClick=function(e,t){this.updateUIClasses({mouse:r.g.cursors.MOVE}),e.point.updateCoordinate("",t.lngLat.lng,t.lngLat.lat),this.map.fire(r.g.events.CREATE,{features:[e.point.toGeoJSON()]}),this.changeMode(r.g.modes.SIMPLE_SELECT,{featureIds:[e.point.id]})},i.onStop=function(e){this.activateUIButton(),e.point.getCoordinate().length||this.deleteFeature([e.point.id],{silent:!0})},i.toDisplayFeatures=function(e,t,n){const o=t.properties.id===e.point.id;if(t.properties.active=o?r.g.activeStates.ACTIVE:r.g.activeStates.INACTIVE,!o)return n(t)},i.onTrash=i.stopDrawingAndRemove,i.onKeyUp=function(e,t){if(o.a.isEscapeKey(t)||o.a.isEnterKey(t))return this.stopDrawingAndRemove(e,t)},t.default=i},function(e,t,n){"use strict";n.r(t);var o=n(1),r=n(4),i=n(2),s=n(0),a=n(3);const c={onSetup:function(e){const t=(e=e||{}).featureId;let n,o,r="forward";if(t){if(!(n=this.getFeature(t)))throw new Error("Could not find a feature with the provided featureId");let i=e.from;if(i&&"Feature"===i.type&&i.geometry&&"Point"===i.geometry.type&&(i=i.geometry),i&&"Point"===i.type&&i.coordinates&&2===i.coordinates.length&&(i=i.coordinates),!i||!Array.isArray(i))throw new Error("Please use the `from` property to indicate which point to continue the line from");const s=n.coordinates.length-1;if(n.coordinates[s][0]===i[0]&&n.coordinates[s][1]===i[1])o=s+1,n.addCoordinate(o,...n.coordinates[s]);else{if(n.coordinates[0][0]!==i[0]||n.coordinates[0][1]!==i[1])throw new Error("`from` should match the point at either the start or the end of the provided LineString");r="backwards",o=0,n.addCoordinate(o,...n.coordinates[0])}}else n=this.newFeature({type:s.g.geojsonTypes.FEATURE,properties:{_type_:s.g.geojsonTypes.LINE_STRING},geometry:{type:s.g.geojsonTypes.LINE_STRING,coordinates:[]}}),o=0,this.addFeature(n);return this.clearSelectedFeatures(),i.a.disable(this),this.updateUIClasses({mouse:s.g.cursors.ADD}),this.activateUIButton(s.g.types.LINE),this.setActionableState({trash:!0}),{line:n,currentVertexPosition:o,direction:r}},clickAnywhere:function(e,t){if(e.currentVertexPosition>0&&Object(r.a)(t,e.line.coordinates[e.currentVertexPosition-1])||"backwards"===e.direction&&Object(r.a)(t,e.line.coordinates[e.currentVertexPosition+1]))return this.changeMode(s.g.modes.SIMPLE_SELECT,{featureIds:[e.line.id]});this.updateUIClasses({mouse:s.g.cursors.ADD}),e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat),"forward"===e.direction?(e.currentVertexPosition++,e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat)):e.line.addCoordinate(0,t.lngLat.lng,t.lngLat.lat)},clickOnVertex:function(e){return this.changeMode(s.g.modes.SIMPLE_SELECT,{featureIds:[e.line.id]})},onMouseMove:function(e,t){e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat),o.a.isVertex(t)&&this.updateUIClasses({mouse:s.g.cursors.POINTER})}};c.onTap=c.onClick=function(e,t){if(o.a.isVertex(t))return this.clickOnVertex(e,t);this.clickAnywhere(e,t)},c.onKeyUp=function(e,t){o.a.isEnterKey(t)?this.changeMode(s.g.modes.SIMPLE_SELECT,{featureIds:[e.line.id]}):o.a.isEscapeKey(t)&&(this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(s.g.modes.SIMPLE_SELECT))},c.onStop=function(e){i.a.enable(this),this.activateUIButton(),void 0!==this.getFeature(e.line.id)&&(e.line.removeCoordinate(`${e.currentVertexPosition}`),e.line.isValid()?this.map.fire(s.g.events.CREATE,{features:[e.line.toGeoJSON()]}):(this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(s.g.modes.SIMPLE_SELECT,{},{silent:!0})))},c.onTrash=function(e){this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(s.g.modes.SIMPLE_SELECT)},c.toDisplayFeatures=function(e,t,n){const o=t.properties.id===e.line.id;if(t.properties.active=o?s.g.activeStates.ACTIVE:s.g.activeStates.INACTIVE,!o)return n(t);t.geometry.coordinates.length<2||(t.properties.meta=s.g.meta.FEATURE,n(Object(a.a)(e.line.id,t.geometry.coordinates["forward"===e.direction?t.geometry.coordinates.length-2:1],`${"forward"===e.direction?t.geometry.coordinates.length-2:1}`,!1)),n(t))},t.default=c},function(e,t,n){"use strict";n.r(t);var o=n(20),r=n(22),i=n(2),s=n(0),a=n(1),c=n(21);const{noTarget:u,isOfMetaType:l,isInactiveFeature:d,isShiftDown:h}=a.a,p=l(s.g.meta.VERTEX),g=l(s.g.meta.MIDPOINT),f={fireUpdate:function(){this.map.fire(s.g.events.UPDATE,{action:s.g.updateActions.CHANGE_COORDINATES,features:this.getSelected().map(e=>e.toGeoJSON())})},fireActionable:function(e){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:e.selectedCoordPaths.length>0})},startDragging:function(e,t){this.map.dragPan.disable(),e.canDragMove=!0,e.dragMoveLocation=t.lngLat},stopDragging:function(e){this.map.dragPan.enable(),e.dragMoving=!1,e.canDragMove=!1,e.dragMoveLocation=null},onVertex:function(e,t){this.startDragging(e,t);const n=t.featureTarget.properties,o=e.selectedCoordPaths.indexOf(n.coord_path);h(t)||-1!==o?h(t)&&-1===o&&e.selectedCoordPaths.push(n.coord_path):e.selectedCoordPaths=[n.coord_path];const r=this.pathsToCoordinates(e.featureId,e.selectedCoordPaths);this.setSelectedCoordinates(r)},onMidpoint:function(e,t){this.startDragging(e,t);const n=t.featureTarget.properties;e.feature.addCoordinate(n.coord_path,n.lng,n.lat),this.fireUpdate(),e.selectedCoordPaths=[n.coord_path]},pathsToCoordinates:function(e,t){return t.map(t=>({feature_id:e,coord_path:t}))},onFeature:function(e,t){0===e.selectedCoordPaths.length?this.startDragging(e,t):this.stopDragging(e)},dragFeature:function(e,t,n){Object(c.a)(this.getSelected(),n),e.dragMoveLocation=t.lngLat},dragVertex:function(e,t,n){const o=e.selectedCoordPaths.map(t=>e.feature.getCoordinate(t)),i=o.map(e=>({type:s.g.geojsonTypes.FEATURE,properties:{},geometry:{type:s.g.geojsonTypes.POINT,coordinates:e}})),a=Object(r.a)(i,n);for(let t=0;t<o.length;t++){const n=o[t];e.feature.updateCoordinate(e.selectedCoordPaths[t],n[0]+a.lng,n[1]+a.lat)}},clickNoTarget:function(){this.changeMode(s.g.modes.SIMPLE_SELECT)},clickInactive:function(){this.changeMode(s.g.modes.SIMPLE_SELECT)},clickActiveFeature:function(e){e.selectedCoordPaths=[],this.clearSelectedCoordinates(),e.feature.changed()},onSetup:function(e){const t=e.featureId,n=this.getFeature(t);n.properties._type_;if(!n)throw new Error("You must provide a featureId to enter direct_select mode");if(n.type===s.g.geojsonTypes.POINT)throw new TypeError("direct_select mode doesn't handle point features");const o={featureId:t,feature:n,dragMoveLocation:e.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:e.coordPath?[e.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(t,o.selectedCoordPaths)),this.setSelected(t),i.a.disable(this),this.setActionableState({trash:!0}),o},onStop:function(){i.a.enable(this),this.clearSelectedCoordinates()},toDisplayFeatures:function(e,t,n){e.featureId===t.properties.id?(t.properties.active=s.g.activeStates.ACTIVE,n(t),Object(o.a)(t,{map:this.map,midpoints:!0,selectedPaths:e.selectedCoordPaths}).forEach(n)):(t.properties.active=s.g.activeStates.INACTIVE,n(t)),this.fireActionable(e)},onTrash:function(e){e.selectedCoordPaths.sort().reverse().forEach(t=>e.feature.removeCoordinate(t)),this.map.fire(s.g.events.UPDATE,{action:s.g.updateActions.CHANGE_COORDINATES,features:this.getSelected().map(e=>e.toGeoJSON())}),e.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(e),!1===e.feature.isValid()&&(this.deleteFeature([e.featureId]),this.changeMode(s.g.modes.SIMPLE_SELECT,{}))},onMouseMove:function(e,t){const n=a.a.isActiveFeature(t),o=p(t),r=0===e.selectedCoordPaths.length;n&&r?this.updateUIClasses({mouse:s.g.cursors.MOVE}):o&&!r?this.updateUIClasses({mouse:s.g.cursors.MOVE}):this.updateUIClasses({mouse:s.g.cursors.NONE}),this.stopDragging(e)},onMouseOut:function(e){e.dragMoving&&this.fireUpdate()}};f.onTouchStart=f.onMouseDown=function(e,t){return p(t)?this.onVertex(e,t):a.a.isActiveFeature(t)?this.onFeature(e,t):g(t)?this.onMidpoint(e,t):void 0},f.onDrag=function(e,t){if(!0!==e.canDragMove)return;e.dragMoving=!0,t.originalEvent.stopPropagation();const n={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};e.selectedCoordPaths.length>0?this.dragVertex(e,t,n):this.dragFeature(e,t,n),e.dragMoveLocation=t.lngLat},f.onClick=function(e,t){return u(t)?this.clickNoTarget(e,t):a.a.isActiveFeature(t)?this.clickActiveFeature(e,t):d(t)?this.clickInactive(e,t):void this.stopDragging(e)},f.onTap=function(e,t){return u(t)?this.clickNoTarget(e,t):a.a.isActiveFeature(t)?this.clickActiveFeature(e,t):d(t)?this.clickInactive(e,t):void 0},f.onTouchEnd=f.onMouseUp=function(e){e.dragMoving&&this.fireUpdate(),this.stopDragging(e)},t.default=f},function(e,t,n){var o=n(46),r=n(43);e.exports.hint=function(e,t){var n,i=[];if("object"==typeof e)n=e;else{if("string"!=typeof e)return[{message:"Expected string or object as input",line:0}];try{n=o.parse(e)}catch(e){var s=e.message.match(/line (\d+)/);return[{line:parseInt(s[1],10)-1,message:e.message,error:e}]}}return i=i.concat(r.hint(n,t))}},function(e,t,n){(function(e,n){var o=200,r="__lodash_hash_undefined__",i=1,s=2,a=9007199254740991,c="[object Arguments]",u="[object Array]",l="[object AsyncFunction]",d="[object Boolean]",h="[object Date]",p="[object Error]",g="[object Function]",f="[object GeneratorFunction]",y="[object Map]",m="[object Number]",_="[object Null]",E="[object Object]",v="[object Proxy]",b="[object RegExp]",T="[object Set]",C="[object String]",I="[object Symbol]",S="[object Undefined]",O="[object ArrayBuffer]",L="[object DataView]",M=/^\[object .+?Constructor\]$/,x=/^(?:0|[1-9]\d*)$/,A={};A["[object Float32Array]"]=A["[object Float64Array]"]=A["[object Int8Array]"]=A["[object Int16Array]"]=A["[object Int32Array]"]=A["[object Uint8Array]"]=A["[object Uint8ClampedArray]"]=A["[object Uint16Array]"]=A["[object Uint32Array]"]=!0,A[c]=A[u]=A[O]=A[d]=A[L]=A[h]=A[p]=A[g]=A[y]=A[m]=A[E]=A[b]=A[T]=A[C]=A["[object WeakMap]"]=!1;var w="object"==typeof e&&e&&e.Object===Object&&e,N="object"==typeof self&&self&&self.Object===Object&&self,P=w||N||Function("return this")(),R="object"==typeof t&&t&&!t.nodeType&&t,F=R&&"object"==typeof n&&n&&!n.nodeType&&n,j=F&&F.exports===R,k=j&&w.process,D=function(){try{return k&&k.binding&&k.binding("util")}catch(e){}}(),U=D&&D.isTypedArray;function V(e,t){for(var n=-1,o=null==e?0:e.length;++n<o;)if(t(e[n],n,e))return!0;return!1}function G(e){var t=-1,n=Array(e.size);return e.forEach(function(e,o){n[++t]=[o,e]}),n}function $(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}var B,J,W,Y=Array.prototype,H=Function.prototype,z=Object.prototype,K=P["__core-js_shared__"],X=H.toString,q=z.hasOwnProperty,Z=(B=/[^.]+$/.exec(K&&K.keys&&K.keys.IE_PROTO||""))?"Symbol(src)_1."+B:"",Q=z.toString,ee=RegExp("^"+X.call(q).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),te=j?P.Buffer:void 0,ne=P.Symbol,oe=P.Uint8Array,re=z.propertyIsEnumerable,ie=Y.splice,se=ne?ne.toStringTag:void 0,ae=Object.getOwnPropertySymbols,ce=te?te.isBuffer:void 0,ue=(J=Object.keys,W=Object,function(e){return J(W(e))}),le=De(P,"DataView"),de=De(P,"Map"),he=De(P,"Promise"),pe=De(P,"Set"),ge=De(P,"WeakMap"),fe=De(Object,"create"),ye=$e(le),me=$e(de),_e=$e(he),Ee=$e(pe),ve=$e(ge),be=ne?ne.prototype:void 0,Te=be?be.valueOf:void 0;function Ce(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}function Ie(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}function Se(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}function Oe(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Se;++t<n;)this.add(e[t])}function Le(e){var t=this.__data__=new Ie(e);this.size=t.size}function Me(e,t){var n=We(e),o=!n&&Je(e),r=!n&&!o&&Ye(e),i=!n&&!o&&!r&&qe(e),s=n||o||r||i,a=s?function(e,t){for(var n=-1,o=Array(e);++n<e;)o[n]=t(n);return o}(e.length,String):[],c=a.length;for(var u in e)!t&&!q.call(e,u)||s&&("length"==u||r&&("offset"==u||"parent"==u)||i&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Ge(u,c))||a.push(u);return a}function xe(e,t){for(var n=e.length;n--;)if(Be(e[n][0],t))return n;return-1}function Ae(e){return null==e?void 0===e?S:_:se&&se in Object(e)?function(e){var t=q.call(e,se),n=e[se];try{e[se]=void 0;var o=!0}catch(e){}var r=Q.call(e);o&&(t?e[se]=n:delete e[se]);return r}(e):function(e){return Q.call(e)}(e)}function we(e){return Xe(e)&&Ae(e)==c}function Ne(e,t,n,o,r){return e===t||(null==e||null==t||!Xe(e)&&!Xe(t)?e!=e&&t!=t:function(e,t,n,o,r,a){var l=We(e),g=We(t),f=l?u:Ve(e),_=g?u:Ve(t),v=(f=f==c?E:f)==E,S=(_=_==c?E:_)==E,M=f==_;if(M&&Ye(e)){if(!Ye(t))return!1;l=!0,v=!1}if(M&&!v)return a||(a=new Le),l||qe(e)?Fe(e,t,n,o,r,a):function(e,t,n,o,r,a,c){switch(n){case L:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case O:return!(e.byteLength!=t.byteLength||!a(new oe(e),new oe(t)));case d:case h:case m:return Be(+e,+t);case p:return e.name==t.name&&e.message==t.message;case b:case C:return e==t+"";case y:var u=G;case T:var l=o&i;if(u||(u=$),e.size!=t.size&&!l)return!1;var g=c.get(e);if(g)return g==t;o|=s,c.set(e,t);var f=Fe(u(e),u(t),o,r,a,c);return c.delete(e),f;case I:if(Te)return Te.call(e)==Te.call(t)}return!1}(e,t,f,n,o,r,a);if(!(n&i)){var x=v&&q.call(e,"__wrapped__"),A=S&&q.call(t,"__wrapped__");if(x||A){var w=x?e.value():e,N=A?t.value():t;return a||(a=new Le),r(w,N,n,o,a)}}if(!M)return!1;return a||(a=new Le),function(e,t,n,o,r,s){var a=n&i,c=je(e),u=c.length,l=je(t).length;if(u!=l&&!a)return!1;for(var d=u;d--;){var h=c[d];if(!(a?h in t:q.call(t,h)))return!1}var p=s.get(e);if(p&&s.get(t))return p==t;var g=!0;s.set(e,t),s.set(t,e);for(var f=a;++d<u;){h=c[d];var y=e[h],m=t[h];if(o)var _=a?o(m,y,h,t,e,s):o(y,m,h,e,t,s);if(!(void 0===_?y===m||r(y,m,n,o,s):_)){g=!1;break}f||(f="constructor"==h)}if(g&&!f){var E=e.constructor,v=t.constructor;E!=v&&"constructor"in e&&"constructor"in t&&!("function"==typeof E&&E instanceof E&&"function"==typeof v&&v instanceof v)&&(g=!1)}return s.delete(e),s.delete(t),g}(e,t,n,o,r,a)}(e,t,n,o,Ne,r))}function Pe(e){return!(!Ke(e)||Z&&Z in e)&&(He(e)?ee:M).test($e(e))}function Re(e){if(n=(t=e)&&t.constructor,o="function"==typeof n&&n.prototype||z,t!==o)return ue(e);var t,n,o,r=[];for(var i in Object(e))q.call(e,i)&&"constructor"!=i&&r.push(i);return r}function Fe(e,t,n,o,r,a){var c=n&i,u=e.length,l=t.length;if(u!=l&&!(c&&l>u))return!1;var d=a.get(e);if(d&&a.get(t))return d==t;var h=-1,p=!0,g=n&s?new Oe:void 0;for(a.set(e,t),a.set(t,e);++h<u;){var f=e[h],y=t[h];if(o)var m=c?o(y,f,h,t,e,a):o(f,y,h,e,t,a);if(void 0!==m){if(m)continue;p=!1;break}if(g){if(!V(t,function(e,t){if(i=t,!g.has(i)&&(f===e||r(f,e,n,o,a)))return g.push(t);var i})){p=!1;break}}else if(f!==y&&!r(f,y,n,o,a)){p=!1;break}}return a.delete(e),a.delete(t),p}function je(e){return function(e,t,n){var o=t(e);return We(e)?o:function(e,t){for(var n=-1,o=t.length,r=e.length;++n<o;)e[r+n]=t[n];return e}(o,n(e))}(e,Ze,Ue)}function ke(e,t){var n,o,r=e.__data__;return("string"==(o=typeof(n=t))||"number"==o||"symbol"==o||"boolean"==o?"__proto__"!==n:null===n)?r["string"==typeof t?"string":"hash"]:r.map}function De(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return Pe(n)?n:void 0}Ce.prototype.clear=function(){this.__data__=fe?fe(null):{},this.size=0},Ce.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Ce.prototype.get=function(e){var t=this.__data__;if(fe){var n=t[e];return n===r?void 0:n}return q.call(t,e)?t[e]:void 0},Ce.prototype.has=function(e){var t=this.__data__;return fe?void 0!==t[e]:q.call(t,e)},Ce.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=fe&&void 0===t?r:t,this},Ie.prototype.clear=function(){this.__data__=[],this.size=0},Ie.prototype.delete=function(e){var t=this.__data__,n=xe(t,e);return!(n<0||(n==t.length-1?t.pop():ie.call(t,n,1),--this.size,0))},Ie.prototype.get=function(e){var t=this.__data__,n=xe(t,e);return n<0?void 0:t[n][1]},Ie.prototype.has=function(e){return xe(this.__data__,e)>-1},Ie.prototype.set=function(e,t){var n=this.__data__,o=xe(n,e);return o<0?(++this.size,n.push([e,t])):n[o][1]=t,this},Se.prototype.clear=function(){this.size=0,this.__data__={hash:new Ce,map:new(de||Ie),string:new Ce}},Se.prototype.delete=function(e){var t=ke(this,e).delete(e);return this.size-=t?1:0,t},Se.prototype.get=function(e){return ke(this,e).get(e)},Se.prototype.has=function(e){return ke(this,e).has(e)},Se.prototype.set=function(e,t){var n=ke(this,e),o=n.size;return n.set(e,t),this.size+=n.size==o?0:1,this},Oe.prototype.add=Oe.prototype.push=function(e){return this.__data__.set(e,r),this},Oe.prototype.has=function(e){return this.__data__.has(e)},Le.prototype.clear=function(){this.__data__=new Ie,this.size=0},Le.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Le.prototype.get=function(e){return this.__data__.get(e)},Le.prototype.has=function(e){return this.__data__.has(e)},Le.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Ie){var r=n.__data__;if(!de||r.length<o-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Se(r)}return n.set(e,t),this.size=n.size,this};var Ue=ae?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var n=-1,o=null==e?0:e.length,r=0,i=[];++n<o;){var s=e[n];t(s,n,e)&&(i[r++]=s)}return i}(ae(e),function(t){return re.call(e,t)}))}:function(){return[]},Ve=Ae;function Ge(e,t){return!!(t=null==t?a:t)&&("number"==typeof e||x.test(e))&&e>-1&&e%1==0&&e<t}function $e(e){if(null!=e){try{return X.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Be(e,t){return e===t||e!=e&&t!=t}(le&&Ve(new le(new ArrayBuffer(1)))!=L||de&&Ve(new de)!=y||he&&"[object Promise]"!=Ve(he.resolve())||pe&&Ve(new pe)!=T||ge&&"[object WeakMap]"!=Ve(new ge))&&(Ve=function(e){var t=Ae(e),n=t==E?e.constructor:void 0,o=n?$e(n):"";if(o)switch(o){case ye:return L;case me:return y;case _e:return"[object Promise]";case Ee:return T;case ve:return"[object WeakMap]"}return t});var Je=we(function(){return arguments}())?we:function(e){return Xe(e)&&q.call(e,"callee")&&!re.call(e,"callee")},We=Array.isArray;var Ye=ce||function(){return!1};function He(e){if(!Ke(e))return!1;var t=Ae(e);return t==g||t==f||t==l||t==v}function ze(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=a}function Ke(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Xe(e){return null!=e&&"object"==typeof e}var qe=U?function(e){return function(t){return e(t)}}(U):function(e){return Xe(e)&&ze(e.length)&&!!A[Ae(e)]};function Ze(e){return null!=(t=e)&&ze(t.length)&&!He(t)?Me(e):Re(e);var t}n.exports=function(e,t){return Ne(e,t)}}).call(this,n(47),n(30)(e))},function(e,t,n){"use strict";function o(e,t){this.x=e,this.y=t}e.exports=o,o.prototype={clone:function(){return new o(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,n=e.y-this.y;return t*t+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[0]*this.x+e[1]*this.y,n=e[2]*this.x+e[3]*this.y;return this.x=t,this.y=n,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),n=Math.sin(e),o=t*this.x-n*this.y,r=n*this.x+t*this.y;return this.x=o,this.y=r,this},_rotateAround:function(e,t){var n=Math.cos(e),o=Math.sin(e),r=t.x+n*(this.x-t.x)-o*(this.y-t.y),i=t.y+o*(this.x-t.x)+n*(this.y-t.y);return this.x=r,this.y=i,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},o.convert=function(e){return e instanceof o?e:Array.isArray(e)?new o(e[0],e[1]):e}},function(e,t,n){var o=n(52),r=n(49),i=n(48),s={features:["FeatureCollection"],coordinates:["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],geometry:["Feature"],geometries:["GeometryCollection"]},a=Object.keys(s);function c(e){for(var t=i(),n=o(e),r=0;r<n.length;r++)t.include(n[r]);return t}e.exports=function(e){return c(e).bbox()},e.exports.polygon=function(e){return c(e).polygon()},e.exports.bboxify=function(e){return r(e).map(function(e){e&&(a.some(function(t){return!!e[t]&&-1!==s[t].indexOf(e.type)})&&(e.bbox=c(e).bbox(),this.update(e)))})}},function(e,t,n){var o=n(54);function r(e){var t=0;if(e&&e.length>0){t+=Math.abs(i(e[0]));for(var n=1;n<e.length;n++)t-=Math.abs(i(e[n]))}return t}function i(e){var t,n,r,i,a,c,u=0,l=e.length;if(l>2){for(c=0;c<l;c++)c===l-2?(r=l-2,i=l-1,a=0):c===l-1?(r=l-1,i=0,a=1):(r=c,i=c+1,a=c+2),t=e[r],n=e[i],u+=(s(e[a][0])-s(t[0]))*Math.sin(s(n[1]));u=u*o.RADIUS*o.RADIUS/2}return u}function s(e){return e*Math.PI/180}e.exports.geometry=function e(t){var n,o=0;switch(t.type){case"Polygon":return r(t.coordinates);case"MultiPolygon":for(n=0;n<t.coordinates.length;n++)o+=r(t.coordinates[n]);return o;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(n=0;n<t.geometries.length;n++)o+=e(t.geometries[n]);return o}},e.exports.ring=i},function(e,t,n){"use strict";n.r(t);var o=n(19);function r(e,t){const n={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},o={on:function(e,t,o){if(void 0===n[e])throw new Error(`Invalid event type: ${e}`);n[e].push({selector:t,fn:o})},render:function(e){t.store.featureChanged(e)}},r=function(e,r){const i=n[e];let s=i.length;for(;s--;){const e=i[s];if(e.selector(r)){e.fn.call(o,r),t.store.render(),t.ui.updateMapClasses();break}}};return e.start.call(o),{render:e.render,stop:function(){e.stop&&e.stop()},trash:function(){e.trash&&(e.trash(),t.store.render())},combineFeatures:function(){e.combineFeatures&&e.combineFeatures()},uncombineFeatures:function(){e.uncombineFeatures&&e.uncombineFeatures()},drag:function(e){r("drag",e)},click:function(e){r("click",e)},mousemove:function(e){r("mousemove",e)},mousedown:function(e){r("mousedown",e)},mouseup:function(e){r("mouseup",e)},mouseout:function(e){r("mouseout",e)},keydown:function(e){r("keydown",e)},keyup:function(e){r("keyup",e)},touchstart:function(e){r("touchstart",e)},touchmove:function(e){r("touchmove",e)},touchend:function(e){r("touchend",e)},tap:function(e){r("tap",e)}}}var i=n(7),s=n(0);function a(e,t){const n=i.a.click(e,null,t),o={mouse:s.g.cursors.NONE};return n[0]&&(o.mouse=n[0].properties.active===s.g.activeStates.ACTIVE?s.g.cursors.MOVE:s.g.cursors.POINTER,o.feature=n[0].properties.meta),-1!==t.events.currentModeName().indexOf("draw")&&(o.mouse=s.g.cursors.ADD),t.ui.queueMapClasses(o),t.ui.updateMapClasses(),n[0]}var c=function(e,t){const n=e.x-t.x,o=e.y-t.y;return Math.sqrt(n*n+o*o)};const u=4,l=12,d=500;function h(e,t,n={}){const o=null!=n.fineTolerance?n.fineTolerance:u,r=null!=n.grossTolerance?n.grossTolerance:l,i=null!=n.interval?n.interval:d;e.point=e.point||t.point,e.time=e.time||t.time;const s=c(e.point,t.point);return s<o||s<r&&t.time-e.time<i}const p=25,g=250;function f(e,t,n={}){const o=null!=n.tolerance?n.tolerance:p,r=null!=n.interval?n.interval:g;return e.point=e.point||t.point,e.time=e.time||t.time,c(e.point,t.point)<o&&t.time-e.time<r}var y=n(18),m=function(e){console.log(e.options.modes);const t=Object.keys(e.options.modes).reduce((t,n)=>(t[n]=Object(y.default)(e.options.modes[n]),t),{});let n={},o={};const c={};let u=null,l=null;const d=[s.g.geojsonTypes.CIRCLE,s.g.geojsonTypes.SECTOR];c.drag=function(t,n){n({point:t.point,time:(new Date).getTime()})?(e.ui.queueMapClasses({mouse:s.g.cursors.DRAG}),l.drag(t)):t.originalEvent.stopPropagation()},c.mousedrag=function(e){c.drag(e,e=>!h(n,e))},c.touchdrag=function(e){c.drag(e,e=>!f(o,e))},c.mousemove=function(t){if(1===(void 0!==t.originalEvent.buttons?t.originalEvent.buttons:t.originalEvent.which))return c.mousedrag(t);const n=a(t,e);t.featureTarget=n,l.mousemove(t)},c.mousedown=function(t){n={time:(new Date).getTime(),point:t.point};const o=a(t,e);t.featureTarget=o,l.mousedown(t)},c.mouseup=function(t){const o=a(t,e);t.featureTarget=o,h(n,{point:t.point,time:(new Date).getTime()})?l.click(t):l.mouseup(t)},c.mouseout=function(e){l.mouseout(e)},c.touchstart=function(t){if(t.originalEvent.preventDefault(),!e.options.touchEnabled)return;o={time:(new Date).getTime(),point:t.point};const n=i.a.touch(t,null,e)[0];t.featureTarget=n,l.touchstart(t)},c.touchmove=function(t){if(t.originalEvent.preventDefault(),e.options.touchEnabled)return l.touchmove(t),c.touchdrag(t)},c.touchend=function(t){if(t.originalEvent.preventDefault(),!e.options.touchEnabled)return;const n=i.a.touch(t,null,e)[0];t.featureTarget=n,f(o,{time:(new Date).getTime(),point:t.point})?l.tap(t):l.touchend(t)};const p=e=>!(8===e||46===e||e>=48&&e<=57);function g(n,o,i={}){if(!function(t){if(t){const{featureId:n}=t;if(n){const t=e.store.get(n);if(t&&t.properties){const e=t.properties._type_;if(-1!==d.indexOf(e))return!1}}}return!0}(o))return;l.stop();const a=t[n];if(void 0===a)throw new Error(`${n} is not valid`);u=n;const c=a(e,o);l=r(c,e),i.silent||e.map.fire(s.g.events.MODE_CHANGE,{mode:n}),e.store.setDirty(),e.store.render()}c.keydown=function(t){"mapboxgl-canvas"===(t.srcElement||t.target).classList[0]&&(8!==t.keyCode&&46!==t.keyCode||!e.options.controls.trash?p(t.keyCode)?l.keydown(t):49===t.keyCode&&e.options.controls.point?g(s.g.modes.DRAW_POINT):50===t.keyCode&&e.options.controls.line_string?g(s.g.modes.DRAW_LINE_STRING):51===t.keyCode&&e.options.controls.polygon&&g(s.g.modes.DRAW_POLYGON):(t.preventDefault(),l.trash()))},c.keyup=function(e){p(e.keyCode)&&l.keyup(e)},c.zoomend=function(){e.store.changeZoom()},c.data=function(t){if("style"===t.dataType){const{setup:t,map:n,options:o,store:r}=e;o.styles.some(e=>n.getLayer(e.id))||(t.addLayers(),r.setDirty(),r.render())}};const m={trash:!1,combineFeatures:!1,uncombineFeatures:!1};return{start:function(){u=e.options.defaultMode,l=r(t[u](e),e)},changeMode:g,actionable:function(t){let n=!1;Object.keys(t).forEach(e=>{if(void 0===m[e])throw new Error("Invalid action type");m[e]!==t[e]&&(n=!0),m[e]=t[e]}),n&&e.map.fire(s.g.events.ACTIONABLE,{actions:m})},currentModeName:function(){return u},currentModeRender:function(e,t){return l.render(e,t)},fire:function(e,t){c[e]&&c[e](t)},addEventListeners:function(){e.map.on("mousemove",c.mousemove),e.map.on("mousedown",c.mousedown),e.map.on("mouseup",c.mouseup),e.map.on("data",c.data),e.map.on("touchmove",c.touchmove),e.map.on("touchstart",c.touchstart),e.map.on("touchend",c.touchend),e.container.addEventListener("mouseout",c.mouseout),e.options.keybindings&&(e.container.addEventListener("keydown",c.keydown),e.container.addEventListener("keyup",c.keyup))},removeEventListeners:function(){e.map.off("mousemove",c.mousemove),e.map.off("mousedown",c.mousedown),e.map.off("mouseup",c.mouseup),e.map.off("data",c.data),e.map.off("touchmove",c.touchmove),e.map.off("touchstart",c.touchstart),e.map.off("touchend",c.touchend),e.container.removeEventListener("mouseout",c.mouseout),e.options.keybindings&&(e.container.removeEventListener("keydown",c.keydown),e.container.removeEventListener("keyup",c.keyup))},trash:function(e){l.trash(e)},combineFeatures:function(){l.combineFeatures()},uncombineFeatures:function(){l.uncombineFeatures()},getMode:function(){return u}}};function _(e){return[].concat(e).filter(e=>void 0!==e)}var E=n(6);function v(){const e=this;if(!(e.ctx.map&&void 0!==e.ctx.map.getSource(s.g.sources.HOT)))return c();const t=e.ctx.events.currentModeName();e.ctx.ui.queueMapClasses({mode:t});let n=[],o=[];e.isDirty?o=e.getAllIds():(n=e.getChangedIds().filter(t=>void 0!==e.get(t)),o=e.sources.hot.filter(t=>t.properties.id&&-1===n.indexOf(t.properties.id)&&void 0!==e.get(t.properties.id)).map(e=>e.properties.id)),e.sources.hot=[];const r=e.sources.cold.length;e.sources.cold=e.isDirty?[]:e.sources.cold.filter(e=>{const t=e.properties.id||e.properties.parent;return-1===n.indexOf(t)});const i=r!==e.sources.cold.length||o.length>0;function a(n,o){const r=e.get(n).internal(t);e.ctx.events.currentModeRender(r,t=>{e.sources[o].push(t)})}if(n.forEach(e=>a(e,"hot")),o.forEach(e=>a(e,"cold")),i&&e.ctx.map.getSource(s.g.sources.COLD).setData({type:s.g.geojsonTypes.FEATURE_COLLECTION,features:e.sources.cold}),e.ctx.map.getSource(s.g.sources.HOT).setData({type:s.g.geojsonTypes.FEATURE_COLLECTION,features:e.sources.hot}),e._emitSelectionChange&&(e.ctx.map.fire(s.g.events.SELECTION_CHANGE,{features:e.getSelected().map(e=>e.toGeoJSON()),points:e.getSelectedCoordinates().map(e=>({type:s.g.geojsonTypes.FEATURE,properties:{},geometry:{type:s.g.geojsonTypes.POINT,coordinates:e.coordinates}}))}),e._emitSelectionChange=!1),e._deletedFeaturesToEmit.length){const t=e._deletedFeaturesToEmit.map(e=>e.toGeoJSON());e._deletedFeaturesToEmit=[],e.ctx.map.fire(s.g.events.DELETE,{features:t})}function c(){e.isDirty=!1,e.clearChangedIds()}c(),e.ctx.map.fire(s.g.events.RENDER,{})}const{interactions:b}=s.g;function T(e){const t=this._selectedCoordinates.filter(e=>this._selectedFeatureIds.has(e.feature_id));this._selectedCoordinates.length===t.length||e.silent||(this._emitSelectionChange=!0),this._selectedCoordinates=t}var C=n(5),I=n.n(C);const S=["mode","feature","mouse"];var O=function(e){let t=null,n=null;const o={onRemove:function(){return e.map.off("load",o.connect),clearInterval(n),o.removeLayers(),e.store.restoreMapConfig(),e.ui.removeButtons(),e.events.removeEventListeners(),e.map=null,e.container=null,e.store=null,t&&t.parentNode&&t.parentNode.removeChild(t),t=null,this},connect:function(){e.map.off("load",o.connect),clearInterval(n),o.addLayers(),e.store.storeMapConfig(),e.events.addEventListeners()},onAdd:function(r){{const e=r.fire;r.fire=function(t,n){let o=arguments;return 1===e.length&&1!==arguments.length&&(o=[I()({},{type:t},n)]),e.apply(r,o)}}return e.map=r,e.events=m(e),e.ui=function(e){const t={};let n=null,o={mode:null,feature:null,mouse:null},r={mode:null,feature:null,mouse:null};function i(e,t={}){const o=document.createElement("button");return o.className=`${s.g.classes.CONTROL_BUTTON} ${t.className}`,o.setAttribute("title",t.title),t.container.appendChild(o),o.addEventListener("click",o=>{o.preventDefault(),o.stopPropagation(),o.target!==n?(c(e),t.onActivate()):a()},!0),o}function a(){n&&(n.classList.remove(s.g.classes.ACTIVE_BUTTON),n=null)}function c(e){a();const o=t[e];o&&o&&"trash"!==e&&(o.classList.add(s.g.classes.ACTIVE_BUTTON),n=o)}return{setActiveButton:c,queueMapClasses:function(e){r=I()(r,e)},updateMapClasses:function(){if(!e.container)return;const t=[],n=[];S.forEach(e=>{r[e]!==o[e]&&(t.push(`${e}-${o[e]}`),null!==r[e]&&n.push(`${e}-${r[e]}`))}),t.length>0&&e.container.classList.remove.apply(e.container.classList,t),n.length>0&&e.container.classList.add.apply(e.container.classList,n),o=I()(o,r)},addButtons:function(){const n=e.options.controls,o=document.createElement("div");return o.className=`${s.g.classes.CONTROL_GROUP} ${s.g.classes.CONTROL_BASE}`,n?(n[s.g.types.LINE]&&(t[s.g.types.LINE]=i(s.g.types.LINE,{container:o,className:s.g.classes.CONTROL_BUTTON_LINE,title:`LineString tool ${e.options.keybindings?"(l)":""}`,onActivate:()=>e.events.changeMode(s.g.modes.DRAW_LINE_STRING)})),n[s.g.types.POLYGON]&&(t[s.g.types.POLYGON]=i(s.g.types.POLYGON,{container:o,className:s.g.classes.CONTROL_BUTTON_POLYGON,title:`Polygon tool ${e.options.keybindings?"(p)":""}`,onActivate:()=>e.events.changeMode(s.g.modes.DRAW_POLYGON)})),n[s.g.types.POINT]&&(t[s.g.types.POINT]=i(s.g.types.POINT,{container:o,className:s.g.classes.CONTROL_BUTTON_POINT,title:`Marker tool ${e.options.keybindings?"(m)":""}`,onActivate:()=>e.events.changeMode(s.g.modes.DRAW_POINT)})),n[s.g.types.CIRCLE]&&(t[s.g.types.CIRCLE]=i(s.g.types.CIRCLE,{container:o,className:s.g.classes.CONTROL_BUTTON_CIRCLE,title:`Circle tool ${e.options.keybindings&&"(c)"}`,onActivate:()=>e.events.changeMode(s.g.modes.DRAW_CIRCLE)})),n[s.g.types.TRIANGLE]&&(t[s.g.types.TRIANGLE]=i(s.g.types.TRIANGLE,{container:o,className:s.g.classes.CONTROL_BUTTON_TRIANGLE,title:`Triangle tool ${e.options.keybindings&&"t"}`,onActivate:()=>e.events.changeMode(s.g.modes.DRAW_TRIANGLE)})),n[s.g.types.RECTANGLE]&&(t[s.g.types.RECTANGLE]=i(s.g.types.RECTANGLE,{container:o,className:s.g.classes.CONTROL_BUTTON_RECTANGLE,title:`Rectangle tool ${e.options.keybindings&&"r"}`,onActivate:()=>e.events.changeMode(s.g.modes.DRAW_RECTANGLE)})),n[s.g.types.SECTOR]&&(t[s.g.types.SECTOR]=i(s.g.types.SECTOR,{container:o,className:s.g.classes.CONTROL_BUTTON_SECTOR,title:`Sector tool ${e.options.keybindings&&"s"}`,onActivate:()=>e.events.changeMode(s.g.modes.DRAW_SECTOR)})),n[s.g.types.ARROW]&&(t[s.g.types.ARROW]=i(s.g.types.ARROW,{container:o,className:s.g.classes.CONTROL_BUTTON_ARROW,title:`Arrow tool ${e.options.keybindings&&"a"}`,onActivate:()=>e.events.changeMode(s.g.modes.DRAW_ARROW)})),n.trash&&(t.trash=i("trash",{container:o,className:s.g.classes.CONTROL_BUTTON_TRASH,title:"Delete",onActivate:()=>{e.events.trash()}})),n.combine_features&&(t.combine_features=i("combineFeatures",{container:o,className:s.g.classes.CONTROL_BUTTON_COMBINE_FEATURES,title:"Combine",onActivate:()=>{e.events.combineFeatures()}})),n.uncombine_features&&(t.uncombine_features=i("uncombineFeatures",{container:o,className:s.g.classes.CONTROL_BUTTON_UNCOMBINE_FEATURES,title:"Uncombine",onActivate:()=>{e.events.uncombineFeatures()}})),o):o},removeButtons:function(){Object.keys(t).forEach(e=>{const n=t[e];n.parentNode&&n.parentNode.removeChild(n),delete t[e]})}}}(e),e.container=r.getContainer(),e.store=new class{constructor(e){this._features={},this._featureIds=new E.a,this._selectedFeatureIds=new E.a,this._selectedCoordinates=[],this._changedFeatureIds=new E.a,this._deletedFeaturesToEmit=[],this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=e,this.sources={hot:[],cold:[]},this.render=function(e,t,n){let o,r;function i(){o=!1,r&&(s.apply(n,r),r=!1)}function s(){o?r=arguments:(o=!0,e.apply(n,arguments),setTimeout(i,t))}return s}(v,16,this),this.isDirty=!1}createRenderBatch(){const e=this.render;let t=0;return this.render=function(){t++},()=>{this.render=e,t>0&&this.render()}}setDirty(){return this.isDirty=!0,this}featureChanged(e){return this._changedFeatureIds.add(e),this}getChangedIds(){return this._changedFeatureIds.values()}clearChangedIds(){return this._changedFeatureIds.clear(),this}getAllIds(){return this._featureIds.values()}add(e){return this.featureChanged(e.id),this._features[e.id]=e,this._featureIds.add(e.id),this}delete(e,t={}){return _(e).forEach(e=>{this._featureIds.has(e)&&(this._featureIds.delete(e),this._selectedFeatureIds.delete(e),t.silent||-1===this._deletedFeaturesToEmit.indexOf(this._features[e])&&this._deletedFeaturesToEmit.push(this._features[e]),delete this._features[e],this.isDirty=!0)}),T.call(this,t),this}get(e){return this._features[e]}getAll(){return Object.keys(this._features).map(e=>this._features[e])}select(e,t={}){return _(e).forEach(e=>{this._selectedFeatureIds.has(e)||(this._selectedFeatureIds.add(e),this._changedFeatureIds.add(e),t.silent||(this._emitSelectionChange=!0))}),this}deselect(e,t={}){return _(e).forEach(e=>{this._selectedFeatureIds.has(e)&&(this._selectedFeatureIds.delete(e),this._changedFeatureIds.add(e),t.silent||(this._emitSelectionChange=!0))}),T.call(this,t),this}clearSelected(e={}){return this.deselect(this._selectedFeatureIds.values(),{silent:e.silent}),this}setSelected(e,t={}){return e=_(e),this.deselect(this._selectedFeatureIds.values().filter(t=>-1===e.indexOf(t)),{silent:t.silent}),this.select(e.filter(e=>!this._selectedFeatureIds.has(e)),{silent:t.silent}),this}setSelectedCoordinates(e){return this._selectedCoordinates=e,this._emitSelectionChange=!0,this}clearSelectedCoordinates(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this}getSelectedIds(){return this._selectedFeatureIds.values()}getSelected(){return this._selectedFeatureIds.values().map(e=>this.get(e))}getSelectedCoordinates(){return this._selectedCoordinates.map(e=>({coordinates:this.get(e.feature_id).getCoordinate(e.coord_path)}))}isSelected(e){return this._selectedFeatureIds.has(e)}setFeatureProperty(e,t,n){this.get(e).setProperty(t,n),this.featureChanged(e)}storeMapConfig(){b.forEach(e=>{this.ctx.map[e]&&(this._mapInitialConfig[e]=this.ctx.map[e].isEnabled())})}restoreMapConfig(){Object.keys(this._mapInitialConfig).forEach(e=>{this._mapInitialConfig[e]?this.ctx.map[e].enable():this.ctx.map[e].disable()})}getInitialConfigValue(e){return void 0===this._mapInitialConfig[e]||this._mapInitialConfig[e]}}(e),t=e.ui.addButtons(),e.options.boxSelect&&(r.boxZoom.disable(),r.dragPan.disable(),r.dragPan.enable()),r.loaded()?o.connect():(r.on("load",o.connect),n=setInterval(()=>{r.loaded()&&o.connect()},16)),e.events.start(),t},addLayers:function(){e.map.addSource(s.g.sources.COLD,{data:{type:s.g.geojsonTypes.FEATURE_COLLECTION,features:[]},type:"geojson"}),e.map.addSource(s.g.sources.HOT,{data:{type:s.g.geojsonTypes.FEATURE_COLLECTION,features:[]},type:"geojson"}),e.options.styles.forEach(t=>{e.map.addLayer(t)}),e.store.setDirty(!0),e.store.render()},removeLayers:function(){e.options.styles.forEach(t=>{e.map.getLayer(t.id)&&e.map.removeLayer(t.id)}),e.map.getSource(s.g.sources.COLD)&&e.map.removeSource(s.g.sources.COLD),e.map.getSource(s.g.sources.HOT)&&e.map.removeSource(s.g.sources.HOT)}};return e.setup=o,o},L=n(13);const M={defaultMode:s.g.modes.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:[{id:"gl-draw-polygon-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#3bb2d0","fill-outline-color":"#3bb2d0","fill-opacity":.1}},{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#fbb03b","fill-outline-color":"#fbb03b","fill-opacity":.1}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-polygon-and-line-vertex-stroke-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-color":"#fff"}},{id:"gl-draw-polygon-and-line-vertex-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-point-point-stroke-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-opacity":1,"circle-color":"#fff"}},{id:"gl-draw-point-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#3bb2d0"}},{id:"gl-draw-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["!=","meta","midpoint"]],paint:{"circle-radius":7,"circle-color":"#fff"}},{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":5,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","mode","static"],["==","$type","Polygon"]],paint:{"fill-color":"#404040","fill-outline-color":"#404040","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","mode","static"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-line-static",type:"line",filter:["all",["==","mode","static"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-point-static",type:"circle",filter:["all",["==","mode","static"],["==","$type","Point"]],paint:{"circle-radius":5,"circle-color":"#404040"}}],modes:L.default,controls:{},userProperties:!1},x={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0,circle:!0,triangle:!0,rectangle:!0,sector:!0,arrow:!0},A={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1,circle:!1,triangle:!1,rectangle:!1,sector:!1,arrow:!1};function w(e,t){return e.map(e=>e.source?e:I()(e,{id:`${e.id}.${t}`,source:"hot"===t?s.g.sources.HOT:s.g.sources.COLD}))}var N=n(37),P=n.n(N),R=n(23),F=n.n(R),j=n(14),k=n.n(j),D=n(36),U=n.n(D),V=n(10),G=n(11),$=n(12),B=n(8);const J={Polygon:V.a,LineString:G.a,Point:$.a,MultiPolygon:B.a,MultiLineString:B.a,MultiPoint:B.a};var W=function(e,t={}){return t.modes=s.g.modes,t.getFeatureIdsAt=function(t){return i.a.click({point:t},null,e).map(e=>e.properties.id)},t.getSelectedIds=function(){return e.store.getSelectedIds()},t.getSelected=function(){return{type:s.g.geojsonTypes.FEATURE_COLLECTION,features:e.store.getSelectedIds().map(t=>e.store.get(t)).map(e=>e.toGeoJSON())}},t.getSelectedPoints=function(){return{type:s.g.geojsonTypes.FEATURE_COLLECTION,features:e.store.getSelectedCoordinates().map(e=>({type:s.g.geojsonTypes.FEATURE,properties:{},geometry:{type:s.g.geojsonTypes.POINT,coordinates:e.coordinates}}))}},t.set=function(n){if(void 0===n.type||n.type!==s.g.geojsonTypes.FEATURE_COLLECTION||!Array.isArray(n.features))throw new Error("Invalid FeatureCollection");const o=e.store.createRenderBatch();let r=e.store.getAllIds().slice();const i=t.add(n),a=new E.a(i);return(r=r.filter(e=>!a.has(e))).length&&t.delete(r),o(),i},t.add=function(t){const n=U.a.hint(t,{precisionWarning:!1}).filter(e=>"message"!==e.level);if(n.length)throw new Error(n[0].message);const o=JSON.parse(JSON.stringify(F()(t))).features.map(t=>{if(t.id=t.id||k()(),null===t.geometry)throw new Error("Invalid geometry: null");if(void 0===e.store.get(t.id)||e.store.get(t.id).type!==t.geometry.type){const n=J[t.geometry.type];if(void 0===n)throw new Error(`Invalid geometry type: ${t.geometry.type}.`);const o=new n(e,t);e.store.add(o)}else{const n=e.store.get(t.id);n.properties=t.properties,P()(n.getCoordinates(),t.geometry.coordinates)||n.incomingCoords(t.geometry.coordinates)}return t.id});return e.store.render(),o},t.get=function(t){const n=e.store.get(t);if(n)return n.toGeoJSON()},t.getAll=function(){return{type:s.g.geojsonTypes.FEATURE_COLLECTION,features:e.store.getAll().map(e=>e.toGeoJSON())}},t.delete=function(n){return e.store.delete(n,{silent:!0}),t.getMode()!==s.g.modes.DIRECT_SELECT||e.store.getSelectedIds().length?e.store.render():e.events.changeMode(s.g.modes.SIMPLE_SELECT,void 0,{silent:!0}),t},t.deleteAll=function(){return e.store.delete(e.store.getAllIds(),{silent:!0}),t.getMode()===s.g.modes.DIRECT_SELECT?e.events.changeMode(s.g.modes.SIMPLE_SELECT,void 0,{silent:!0}):e.store.render(),t},t.changeMode=function(n,o={}){return n===s.g.modes.SIMPLE_SELECT&&t.getMode()===s.g.modes.SIMPLE_SELECT?(r=o.featureIds||[],i=e.store.getSelectedIds(),r.length===i.length&&JSON.stringify(r.map(e=>e).sort())===JSON.stringify(i.map(e=>e).sort())?t:(e.store.setSelected(o.featureIds,{silent:!0}),e.store.render(),t)):n===s.g.modes.DIRECT_SELECT&&t.getMode()===s.g.modes.DIRECT_SELECT&&o.featureId===e.store.getSelectedIds()[0]?t:(e.events.changeMode(n,o,{silent:!0}),t);var r,i},t.getMode=function(){return e.events.getMode()},t.trash=function(){return e.events.trash({silent:!0}),t},t.combineFeatures=function(){return e.events.combineFeatures({silent:!0}),t},t.uncombineFeatures=function(){return e.events.uncombineFeatures({silent:!0}),t},t.setFeatureProperty=function(n,o,r){return e.store.setFeatureProperty(n,o,r),t},t};var Y=function(e,t={}){const n={options:e=function(e={}){let t=I()(e);return e.controls||(t.controls={}),!1===e.displayControlsDefault?t.controls=I()(A,e.controls):t.controls=I()(x,e.controls),(t=I()(M,t)).styles=w(t.styles,"cold").concat(w(t.styles,"hot")),t}(e)};t=W(n,t),n.api=t;const o=O(n);return t.onAdd=o.onAdd,t.onRemove=o.onRemove,t.types=s.g.types,t.options=e,t};class H{constructor(){this.cursor=-1,this.recordes=[]}addRecord(e){if(e){this.cursor+1<this.recordes.length&&(this.recordes=this.recordes.slice(0,this.cursor+1)),this.recordes.push(e);const t=this.recordes.length;this.cursor=t-1}return this}undoRecord(){let e=this.recordes.length,t=null;return 0===e?this.cursor=-1:e>0&&this.cursor>-1&&(t=this.recordes[this.cursor],this.cursor=this.cursor-1),t}redoRecord(){let e=this.recordes.length,t=null;return 0===e&&(this.cursor=-1),e>0&&this.cursor<e-1&&(t=this.recordes[this.cursor+1],this.cursor=this.cursor+1),t}getCurrentRecord(){let e=this.recordes.length,t=null;return 0===e?null:(this.cursor>-1&&this.cursor<e&&(t=this.recordes[this.cursor]),t)}getAllRecords(){return this.recordes}clear(){this.cursor=-1,this.recordes=[]}}class z{constructor(e=0,t=0,n=[],o=[]){this.type=e,this.action=t,this.features=n,this.prevFeatures=o}getType(){return this.type}getAction(){return this.action}getFeatures(){return this.features}getPrevFeatures(){return this.prevFeatures}}let K={type:{[s.g.events.DELETE]:1,[s.g.events.UPDATE]:2,[s.g.events.CREATE]:3,[s.g.events.REPLACE]:4},action:{[s.g.updateActions.MOVE]:1,[s.g.updateActions.CHANGE_COORDINATES]:2,[s.g.updateActions.CHANGE_PROPERTIES]:3}};var X=function(e,t,n,o){const r=Object.assign({},{onDrawCreate:function(e){const o=new z(3,0,e.features);n.addRecord(o),t.fire(s.g.events.RECORD_CREATE,{record:o})},onDrawUpdate:function(e){const o=new z(2,K.action[e.action]||0,e.features,e.prevFeatures);n.addRecord(o),t.fire(s.g.events.RECORD_CREATE,{record:o})},onDrawDelete:function(e){const o=new z(1,0,e.features);n.addRecord(o),t.fire(s.g.events.RECORD_CREATE,{record:o})},onDrawCombine:function(e){const o=new z(4,0,e.createdFeatures,e.deletedFeatures);n.addRecord(o),t.fire(s.g.events.RECORD_CREATE,{record:o})},onDrawUncombine:function(e){const o=new z(4,0,e.createdFeatures,e.deletedFeatures);n.addRecord(o),t.fire(s.g.events.RECORD_CREATE,{record:o})},onDrawReplace:function(e){const o=new z(4,0,e.createdFeatures,e.deletedFeatures);n.addRecord(o),t.fire(s.g.events.RECORD_CREATE,{record:o})},onKeydown:function(e){90===e.keyCode?(e.preventDefault(),i.undoHistory()):89===e.keyCode&&(e.preventDefault(),i.redoHistory())}}),i={addEventListeners:function(){t&&(t.on(s.g.events.CREATE,r.onDrawCreate),t.on(s.g.events.UPDATE,r.onDrawUpdate),t.on(s.g.events.DELETE,r.onDrawDelete),t.on(s.g.events.COMBINE_FEATURES,r.onDrawCombine),t.on(s.g.events.UNCOMBINE_FEATURES,r.onDrawUncombine),t.on(s.g.events.REPLACE,r.onDrawReplace),o.addEventListener("keydown",r.onKeydown))},removeEventListeners:function(){t&&(t.off(s.g.events.CREATE,r.onDrawCreate),t.off(s.g.events.UPDATE,r.onDrawUpdate),t.off(s.g.events.DELETE,r.onDrawDelete),t.off(s.g.events.COMBINE_FEATURES,r.onDrawCombine),t.off(s.g.events.UNCOMBINE_FEATURES,r.onDrawUncombine),t.off(s.g.events.REPLACE,r.onDrawReplace),o.removeEventListener("keydown",r.onKeydown))},undoHistory:function(){if(e&&n){const o=n.undoRecord();if(o){const n=o.getType(),r=o.getFeatures(),i=o.getPrevFeatures();switch(n){case 1:if(r.length>0){r.map(t=>{e.add(Object.assign({},t,{type:t.type||s.g.geojsonTypes.FEATURE}))});const t=r.map(e=>e.id);e.changeMode(s.g.modes.SIMPLE_SELECT,{featureIds:t})}break;case 2:if(r.length>0){const t=r.map(e=>e.id);e.delete(t)}if(i.length>0){i.map(t=>{e.add(Object.assign({},t,{type:t.type||s.g.geojsonTypes.FEATURE}))});const t=i.map(e=>e.id);e.changeMode(s.g.modes.SIMPLE_SELECT,{featureIds:t})}break;case 3:if(r.length>0){const t=r.map(e=>e.id);e.delete(t)}break;case 4:if(r.length>0){const t=r.map(e=>e.id);e.delete(t)}if(i.length>0){i.map(t=>{e.add(Object.assign({},t,{type:t.type||s.g.geojsonTypes.FEATURE}))});const t=i.map(e=>e.id);e.changeMode(s.g.modes.SIMPLE_SELECT,{featureIds:t})}}t.fire(s.g.events.UNDO,{record:o})}}},redoHistory:function(){if(e&&n){const o=n.redoRecord();if(o){e.getAll();const n=o.getType(),r=o.getFeatures(),i=o.getPrevFeatures();switch(n){case 3:if(r.length>0){r.map(t=>{e.add(Object.assign({},t,{type:t.type||s.g.geojsonTypes.FEATURE}))});const t=r.map(e=>e.id);e.changeMode(s.g.modes.SIMPLE_SELECT,{featureIds:t})}break;case 2:if(i.length>0){const t=i.map(e=>e.id);e.delete(t)}if(r.length>0){r.map(t=>{e.add(Object.assign({},t,{type:t.type||s.g.geojsonTypes.FEATURE}))});const t=r.map(e=>e.id);e.changeMode(s.g.modes.SIMPLE_SELECT,{featureIds:t})}break;case 1:if(r.length>0){const t=r.map(e=>e.id);e.delete(t)}break;case 4:if(i.length>0){const t=i.map(e=>e.id);e.delete(t)}if(r.length>0){r.map(t=>{e.add(Object.assign({},t,{type:t.type||s.g.geojsonTypes.FEATURE}))});const t=r.map(e=>e.id);e.changeMode(s.g.modes.SIMPLE_SELECT,{featureIds:t})}}t.fire(s.g.events.REDO,{record:o})}}}};return i};let q={};const Z=function(e={}){const t=e;t.map=null,t.options={},t.controlPosition=null,t.events=null,t.draw=null,t.history=null,t.container=null;const n=function(){return{options:t.options||{},controlPosition:t.controlPosition||void 0,draw:t.draw||null}};return{init:function(e,o,r){return t.draw=new Y(o),t.map=e,t.map.addControl(t.draw,r),t.options=o,t.controlPosition=r,t.container=e.getContainer(),t.history&&(t.history=null),t.event&&(t.event.removeEventListeners(),t.event=null),t.history=new H,t.event=new X(t.draw,t.map,t.history,t.container),t.event.addEventListeners(),n()},setOptions:function(e){return t.draw&&t.map&&(t.map.removeControl(t.draw),t.draw=null),t.draw=new Y(e),t.map.addControl(t.draw,t.controlPosition),t.options=e,t.history&&(t.history=null),t.event&&(t.event.removeEventListeners(),t.event=null),t.history=new H,t.event=new X(t.draw,t.map,t.history,t.container),t.event.addEventListeners(),n()},dispose:function(){return t.draw&&t.map&&(t.map.removeControl(t.draw),t.draw=null),t.history&&(t.history=null),t.event&&(t.event.removeEventListeners(),t.event=null),delete t.map,delete t.options,delete t.controlPosition,delete t.history,delete t.event,delete t.draw,delete t.container,n},undoOperation:function(){t.event&&t.event.undoHistory()},redoOperation:function(){t.event&&t.event.redoHistory()},setFeatures:function(e){t.draw.changeMode(s.g.modes.SIMPLE_SELECT),t.draw.set(e)},removeFeatures:function(e){if(!Array.isArray(e))throw new Error("Invalid featureIds");if(0===e.length)throw new Error("featureIds");return t.draw.changeMode(s.g.modes.SIMPLE_SELECT,{featureIds:e}),t.draw.trash(),e},setSelected:function(e){if(!Array.isArray(e))throw new Error("invalid featureIds");return t.draw.changeMode(s.g.modes.SIMPLE_SELECT,{featureIds:e}),e},setFeatureProperties:function(e,n){for(let o in n)if(n.hasOwnProperty(o)){let r=n[o];t.draw.setFeatureProperty(e,o,r)}return t.draw.get(e)},getAllHistoryRecords:function(){return t.history?t.history.getAllRecords():[]},clearHistoryRecords:function(){t.history&&t.history.clear()}}}({});q=Object.assign(q,{init:function(e,t,n){return Object.assign(q,Z.init(e,t,n))},setOptions:function(e){return Object.assign(q,Z.setOptions(e))},dispose:function(){return Object.assign(q,Z.dispose())},undoOperation:function(){Z.undoOperation()},redoOperation:function(){Z.redoOperation()},onBtnCtrlActive:function(e){Object(o.default)(this,e)},setFeatures:function(e){return Z.setFeatures(e)},removeFeatures:function(e){return Z.removeFeatures(e)},setSelected:function(e){return Z.setSelected(e)},setFeatureProperties:function(e,t){return Z.setFeatureProperties(e,t)},getAllHistoryRecords:function(){return Z.getAllHistoryRecords()},clearHistoryRecords:function(){return Z.clearHistoryRecords()}});t.default=q},function(e,t){function n(e){return e*Math.PI/180}function o(e){var t=0;if(e.length>2)for(var o,r,i=0;i<e.length-1;i++)o=e[i],t+=n((r=e[i+1])[0]-o[0])*(2+Math.sin(n(o[1]))+Math.sin(n(r[1])));return t>=0}function r(e){if(e&&e.length>0){if(o(e[0]))return!1;if(!e.slice(1,e.length).every(o))return!1}return!0}e.exports=function(e,t){(function(e){return"Polygon"===e.type?r(e.coordinates):"MultiPolygon"===e.type?e.coordinates.every(r):void 0})(e)||t.push({message:"Polygons and MultiPolygons should follow the right-hand rule",level:"message",line:e.__line__})}},function(e,t,n){var o=n(42);e.exports.hint=function(e,t){var n=[],r=0,i=10,s=6;function a(e){if(t&&!1===t.noDuplicateMembers||!e.__duplicateProperties__||n.push({message:"An object contained duplicate members, making parsing ambigous: "+e.__duplicateProperties__.join(", "),line:e.__line__}),!u(e,"type","string"))if(f[e.type])e&&f[e.type](e);else{var o=y[e.type.toLowerCase()];void 0!==o?n.push({message:"Expected "+o+" but got "+e.type+" (case sensitive)",line:e.__line__}):n.push({message:"The type "+e.type+" is unknown",line:e.__line__})}}function c(e,t){return e.every(function(e){return null!==e&&typeof e===t})}function u(e,t,o){if(void 0===e[t])return n.push({message:'"'+t+'" member required',line:e.__line__});if("array"===o){if(!Array.isArray(e[t]))return n.push({message:'"'+t+'" member should be an array, but is an '+typeof e[t]+" instead",line:e.__line__})}else{if("object"===o&&e[t]&&"Object"!==e[t].constructor.name)return n.push({message:'"'+t+'" member should be '+o+", but is an "+e[t].constructor.name+" instead",line:e.__line__});if(o&&typeof e[t]!==o)return n.push({message:'"'+t+'" member should be '+o+", but is an "+typeof e[t]+" instead",line:e.__line__})}}function l(e,o){if(!Array.isArray(e))return n.push({message:"position should be an array, is a "+typeof e+" instead",line:e.__line__||o});if(e.length<2)return n.push({message:"position must have 2 or more elements",line:e.__line__||o});if(e.length>3)return n.push({message:"position should not have more than 3 elements",level:"message",line:e.__line__||o});if(!c(e,"number"))return n.push({message:"each element in a position must be a number",line:e.__line__||o});if(t&&t.precisionWarning){if(r===i)return r+=1,n.push({message:"truncated warnings: we've encountered coordinate precision warning "+i+" times, no more warnings will be reported",level:"message",line:e.__line__||o});r<i&&e.forEach(function(t){var i=0,a=String(t).split(".")[1];if(void 0!==a&&(i=a.length),i>s)return r+=1,n.push({message:"precision of coordinates should be reduced",level:"message",line:e.__line__||o})})}}function d(e,t,o,r){if(void 0===r&&void 0!==e.__line__&&(r=e.__line__),0===o)return l(e,r);if(1===o&&t)if("LinearRing"===t){if(!Array.isArray(e[e.length-1]))return n.push({message:"a number was found where a coordinate array should have been found: this needs to be nested more deeply",line:r}),!0;if(e.length<4&&n.push({message:"a LinearRing of coordinates needs to have four or more positions",line:r}),e.length&&(e[e.length-1].length!==e[0].length||!e[e.length-1].every(function(t,n){return e[0][n]===t})))return n.push({message:"the first and last positions in a LinearRing of coordinates must be the same",line:r}),!0}else if("Line"===t&&e.length<2)return n.push({message:"a line needs to have two or more coordinates to be valid",line:r});if(Array.isArray(e))return e.map(function(e){return d(e,t,o-1,e.__line__||r)}).some(function(e){return e});n.push({message:"a number was found where a coordinate array should have been found: this needs to be nested more deeply",line:r})}function h(e){e.crs&&("object"==typeof e.crs&&e.crs.properties&&"urn:ogc:def:crs:OGC:1.3:CRS84"===e.crs.properties.name?n.push({message:"old-style crs member is not recommended, this object is equivalent to the default and should be removed",line:e.__line__}):n.push({message:"old-style crs member is not recommended",line:e.__line__}))}function p(e){if(e.bbox)return Array.isArray(e.bbox)?(c(e.bbox,"number")||n.push({message:"each element in a bbox member must be a number",line:e.bbox.__line__}),4!==e.bbox.length&&6!==e.bbox.length&&n.push({message:"bbox must contain 4 elements (for 2D) or 6 elements (for 3D)",line:e.bbox.__line__}),n.length):void n.push({message:"bbox member must be an array of numbers, but is a "+typeof e.bbox,line:e.__line__})}function g(e){h(e),p(e),void 0!==e.id&&"string"!=typeof e.id&&"number"!=typeof e.id&&n.push({message:'Feature "id" member must have a string or number value',line:e.__line__}),void 0!==e.features&&n.push({message:'Feature object cannot contain a "features" member',line:e.__line__}),void 0!==e.coordinates&&n.push({message:'Feature object cannot contain a "coordinates" member',line:e.__line__}),"Feature"!==e.type&&n.push({message:"GeoJSON features must have a type=feature member",line:e.__line__}),u(e,"properties","object"),u(e,"geometry","object")||e.geometry&&a(e.geometry)}var f={Point:function(e){var t;h(e),p(e),void 0!==(t=e).properties&&n.push({message:'geometry object cannot contain a "properties" member',line:t.__line__}),void 0!==t.geometry&&n.push({message:'geometry object cannot contain a "geometry" member',line:t.__line__}),void 0!==t.features&&n.push({message:'geometry object cannot contain a "features" member',line:t.__line__}),u(e,"coordinates","array")||l(e.coordinates)},Feature:g,MultiPoint:function(e){h(e),p(e),u(e,"coordinates","array")||d(e.coordinates,"",1)},LineString:function(e){h(e),p(e),u(e,"coordinates","array")||d(e.coordinates,"Line",1)},MultiLineString:function(e){h(e),p(e),u(e,"coordinates","array")||d(e.coordinates,"Line",2)},FeatureCollection:function(e){if(h(e),p(e),void 0!==e.properties&&n.push({message:'FeatureCollection object cannot contain a "properties" member',line:e.__line__}),void 0!==e.coordinates&&n.push({message:'FeatureCollection object cannot contain a "coordinates" member',line:e.__line__}),!u(e,"features","array")){if(!c(e.features,"object"))return n.push({message:"Every feature must be an object",line:e.__line__});e.features.forEach(g)}},GeometryCollection:function(e){h(e),p(e),u(e,"geometries","array")||(c(e.geometries,"object")||n.push({message:"The geometries array in a GeometryCollection must contain only geometry objects",line:e.__line__}),1===e.geometries.length&&n.push({message:"GeometryCollection with a single geometry should be avoided in favor of single part or a single object of multi-part type",line:e.geometries.__line__}),e.geometries.forEach(function(t){t&&("GeometryCollection"===t.type&&n.push({message:"GeometryCollection should avoid nested geometry collections",line:e.geometries.__line__}),a(t))}))},Polygon:function(e){h(e),p(e),u(e,"coordinates","array")||d(e.coordinates,"LinearRing",2)||o(e,n)},MultiPolygon:function(e){h(e),p(e),u(e,"coordinates","array")||d(e.coordinates,"LinearRing",3)||o(e,n)}},y=Object.keys(f).reduce(function(e,t){return e[t.toLowerCase()]=t,e},{});return"object"!=typeof e||null===e||void 0===e?(n.push({message:"The root of a GeoJSON object must be an object.",line:0}),n):(a(e),n.forEach(function(e){({}).hasOwnProperty.call(e,"line")&&void 0===e.line&&delete e.line}),n)}},function(e,t,n){(function(e){function n(e,t){for(var n=0,o=e.length-1;o>=0;o--){var r=e[o];"."===r?e.splice(o,1):".."===r?(e.splice(o,1),n++):n&&(e.splice(o,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}var o=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,r=function(e){return o.exec(e).slice(1)};function i(e,t){if(e.filter)return e.filter(t);for(var n=[],o=0;o<e.length;o++)t(e[o],o,e)&&n.push(e[o]);return n}t.resolve=function(){for(var t="",o=!1,r=arguments.length-1;r>=-1&&!o;r--){var s=r>=0?arguments[r]:e.cwd();if("string"!=typeof s)throw new TypeError("Arguments to path.resolve must be strings");s&&(t=s+"/"+t,o="/"===s.charAt(0))}return t=n(i(t.split("/"),function(e){return!!e}),!o).join("/"),(o?"/":"")+t||"."},t.normalize=function(e){var o=t.isAbsolute(e),r="/"===s(e,-1);return(e=n(i(e.split("/"),function(e){return!!e}),!o).join("/"))||o||(e="."),e&&r&&(e+="/"),(o?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(i(e,function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},t.relative=function(e,n){function o(e){for(var t=0;t<e.length&&""===e[t];t++);for(var n=e.length-1;n>=0&&""===e[n];n--);return t>n?[]:e.slice(t,n-t+1)}e=t.resolve(e).substr(1),n=t.resolve(n).substr(1);for(var r=o(e.split("/")),i=o(n.split("/")),s=Math.min(r.length,i.length),a=s,c=0;c<s;c++)if(r[c]!==i[c]){a=c;break}var u=[];for(c=a;c<r.length;c++)u.push("..");return(u=u.concat(i.slice(a))).join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){var t=r(e),n=t[0],o=t[1];return n||o?(o&&(o=o.substr(0,o.length-1)),n+o):"."},t.basename=function(e,t){var n=r(e)[2];return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},t.extname=function(e){return r(e)[3]};var s="b"==="ab".substr(-1)?function(e,t,n){return e.substr(t,n)}:function(e,t,n){return t<0&&(t=e.length+t),e.substr(t,n)}}).call(this,n(29))},function(e,t){},function(e,t,n){(function(e,o){var r=function(){var e=function(e,t,n,o){for(n=n||{},o=e.length;o--;n[e[o]]=t);return n},t=[1,12],n=[1,13],o=[1,9],r=[1,10],i=[1,11],s=[1,14],a=[1,15],c=[14,18,22,24],u=[18,22],l=[22,24],d={trace:function(){},yy:{},symbols_:{error:2,JSONString:3,STRING:4,JSONNumber:5,NUMBER:6,JSONNullLiteral:7,NULL:8,JSONBooleanLiteral:9,TRUE:10,FALSE:11,JSONText:12,JSONValue:13,EOF:14,JSONObject:15,JSONArray:16,"{":17,"}":18,JSONMemberList:19,JSONMember:20,":":21,",":22,"[":23,"]":24,JSONElementList:25,$accept:0,$end:1},terminals_:{2:"error",4:"STRING",6:"NUMBER",8:"NULL",10:"TRUE",11:"FALSE",14:"EOF",17:"{",18:"}",21:":",22:",",23:"[",24:"]"},productions_:[0,[3,1],[5,1],[7,1],[9,1],[9,1],[12,2],[13,1],[13,1],[13,1],[13,1],[13,1],[13,1],[15,2],[15,3],[20,3],[19,1],[19,3],[16,2],[16,3],[25,1],[25,3]],performAction:function(e,t,n,o,r,i,s){var a=i.length-1;switch(r){case 1:this.$=e.replace(/\\(\\|")/g,"$1").replace(/\\n/g,"\n").replace(/\\r/g,"\r").replace(/\\t/g,"\t").replace(/\\v/g,"\v").replace(/\\f/g,"\f").replace(/\\b/g,"\b");break;case 2:this.$=Number(e);break;case 3:this.$=null;break;case 4:this.$=!0;break;case 5:this.$=!1;break;case 6:return this.$=i[a-1];case 13:this.$={},Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 14:case 19:this.$=i[a-1],Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 15:this.$=[i[a-2],i[a]];break;case 16:this.$={},this.$[i[a][0]]=i[a][1];break;case 17:this.$=i[a-2],void 0!==i[a-2][i[a][0]]&&(this.$.__duplicateProperties__||Object.defineProperty(this.$,"__duplicateProperties__",{value:[],enumerable:!1}),this.$.__duplicateProperties__.push(i[a][0])),i[a-2][i[a][0]]=i[a][1];break;case 18:this.$=[],Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 20:this.$=[i[a]];break;case 21:this.$=i[a-2],i[a-2].push(i[a])}},table:[{3:5,4:t,5:6,6:n,7:3,8:o,9:4,10:r,11:i,12:1,13:2,15:7,16:8,17:s,23:a},{1:[3]},{14:[1,16]},e(c,[2,7]),e(c,[2,8]),e(c,[2,9]),e(c,[2,10]),e(c,[2,11]),e(c,[2,12]),e(c,[2,3]),e(c,[2,4]),e(c,[2,5]),e([14,18,21,22,24],[2,1]),e(c,[2,2]),{3:20,4:t,18:[1,17],19:18,20:19},{3:5,4:t,5:6,6:n,7:3,8:o,9:4,10:r,11:i,13:23,15:7,16:8,17:s,23:a,24:[1,21],25:22},{1:[2,6]},e(c,[2,13]),{18:[1,24],22:[1,25]},e(u,[2,16]),{21:[1,26]},e(c,[2,18]),{22:[1,28],24:[1,27]},e(l,[2,20]),e(c,[2,14]),{3:20,4:t,20:29},{3:5,4:t,5:6,6:n,7:3,8:o,9:4,10:r,11:i,13:30,15:7,16:8,17:s,23:a},e(c,[2,19]),{3:5,4:t,5:6,6:n,7:3,8:o,9:4,10:r,11:i,13:31,15:7,16:8,17:s,23:a},e(u,[2,17]),e(u,[2,15]),e(l,[2,21])],defaultActions:{16:[2,6]},parseError:function(e,t){if(!t.recoverable){function n(e,t){this.message=e,this.hash=t}throw n.prototype=Error,new n(e,t)}this.trace(e)},parse:function(e){var t=this,n=[0],o=[null],r=[],i=this.table,s="",a=0,c=0,u=0,l=r.slice.call(arguments,1),d=Object.create(this.lexer),h={yy:{}};for(var p in this.yy)Object.prototype.hasOwnProperty.call(this.yy,p)&&(h.yy[p]=this.yy[p]);d.setInput(e,h.yy),h.yy.lexer=d,h.yy.parser=this,void 0===d.yylloc&&(d.yylloc={});var g=d.yylloc;r.push(g);var f=d.options&&d.options.ranges;"function"==typeof h.yy.parseError?this.parseError=h.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var y,m,_,E,v,b,T,C,I,S=function(){var e;return"number"!=typeof(e=d.lex()||1)&&(e=t.symbols_[e]||e),e},O={};;){if(_=n[n.length-1],this.defaultActions[_]?E=this.defaultActions[_]:(null!==y&&void 0!==y||(y=S()),E=i[_]&&i[_][y]),void 0===E||!E.length||!E[0]){var L="";for(b in I=[],i[_])this.terminals_[b]&&b>2&&I.push("'"+this.terminals_[b]+"'");L=d.showPosition?"Parse error on line "+(a+1)+":\n"+d.showPosition()+"\nExpecting "+I.join(", ")+", got '"+(this.terminals_[y]||y)+"'":"Parse error on line "+(a+1)+": Unexpected "+(1==y?"end of input":"'"+(this.terminals_[y]||y)+"'"),this.parseError(L,{text:d.match,token:this.terminals_[y]||y,line:d.yylineno,loc:g,expected:I})}if(E[0]instanceof Array&&E.length>1)throw new Error("Parse Error: multiple actions possible at state: "+_+", token: "+y);switch(E[0]){case 1:n.push(y),o.push(d.yytext),r.push(d.yylloc),n.push(E[1]),y=null,m?(y=m,m=null):(c=d.yyleng,s=d.yytext,a=d.yylineno,g=d.yylloc,u>0&&u--);break;case 2:if(T=this.productions_[E[1]][1],O.$=o[o.length-T],O._$={first_line:r[r.length-(T||1)].first_line,last_line:r[r.length-1].last_line,first_column:r[r.length-(T||1)].first_column,last_column:r[r.length-1].last_column},f&&(O._$.range=[r[r.length-(T||1)].range[0],r[r.length-1].range[1]]),void 0!==(v=this.performAction.apply(O,[s,c,a,h.yy,E[1],o,r].concat(l))))return v;T&&(n=n.slice(0,-1*T*2),o=o.slice(0,-1*T),r=r.slice(0,-1*T)),n.push(this.productions_[E[1]][0]),o.push(O.$),r.push(O._$),C=i[n[n.length-2]][n[n.length-1]],n.push(C);break;case 3:return!0}}return!0}},h={EOF:1,parseError:function(e,t){if(!this.yy.parser)throw new Error(e);this.yy.parser.parseError(e,t)},setInput:function(e,t){return this.yy=t||this.yy||{},this._input=e,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];return this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e,e.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,n=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t),this.offset-=t;var o=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var r=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===o.length?this.yylloc.first_column:0)+o[o.length-n.length].length-n[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[r[0],r[0]+this.yyleng-t]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},test_match:function(e,t){var n,o,r;if(this.options.backtrack_lexer&&(r={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(r.yylloc.range=this.yylloc.range.slice(0))),(o=e[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=o.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:o?o[o.length-1].length-o[o.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],n=this.performAction.call(this,this.yy,this,t,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),n)return n;if(this._backtrack){for(var i in r)this[i]=r[i];return!1}return!1},next:function(){if(this.done)return this.EOF;var e,t,n,o;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var r=this._currentRules(),i=0;i<r.length;i++)if((n=this._input.match(this.rules[r[i]]))&&(!t||n[0].length>t[0].length)){if(t=n,o=i,this.options.backtrack_lexer){if(!1!==(e=this.test_match(n,r[i])))return e;if(this._backtrack){t=!1;continue}return!1}if(!this.options.flex)break}return t?!1!==(e=this.test_match(t,r[o]))&&e:""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return e||this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){return this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(e){return(e=this.conditionStack.length-1-Math.abs(e||0))>=0?this.conditionStack[e]:"INITIAL"},pushState:function(e){this.begin(e)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(e,t,n,o){switch(n){case 0:break;case 1:return 6;case 2:return t.yytext=t.yytext.substr(1,t.yyleng-2),4;case 3:return 17;case 4:return 18;case 5:return 23;case 6:return 24;case 7:return 22;case 8:return 21;case 9:return 10;case 10:return 11;case 11:return 8;case 12:return 14;case 13:return"INVALID"}},rules:[/^(?:\s+)/,/^(?:(-?([0-9]|[1-9][0-9]+))(\.[0-9]+)?([eE][-+]?[0-9]+)?\b)/,/^(?:"(?:\\[\\"bfnrt\/]|\\u[a-fA-F0-9]{4}|[^\\\0-\x09\x0a-\x1f"])*")/,/^(?:\{)/,/^(?:\})/,/^(?:\[)/,/^(?:\])/,/^(?:,)/,/^(?::)/,/^(?:true\b)/,/^(?:false\b)/,/^(?:null\b)/,/^(?:$)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13],inclusive:!0}}};function p(){this.yy={}}return d.lexer=h,p.prototype=d,d.Parser=p,new p}();t.parser=r,t.Parser=r.Parser,t.parse=function(){return r.parse.apply(r,arguments)},t.main=function(o){o[1]||(console.log("Usage: "+o[0]+" FILE"),e.exit(1));var r=n(45).readFileSync(n(44).normalize(o[1]),"utf8");return t.parser.parse(r)},void 0!==o&&n.c[n.s]===o&&t.main(e.argv.slice(1))}).call(this,n(29),n(30)(e))},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t){function n(e){if(!(this instanceof n))return new n(e);this._bbox=e||[1/0,1/0,-1/0,-1/0],this._valid=!!e}e.exports=n,n.prototype.include=function(e){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],e[0]),this._bbox[1]=Math.min(this._bbox[1],e[1]),this._bbox[2]=Math.max(this._bbox[2],e[0]),this._bbox[3]=Math.max(this._bbox[3],e[1]),this},n.prototype.equals=function(e){var t;return t=e instanceof n?e.bbox():e,this._bbox[0]==t[0]&&this._bbox[1]==t[1]&&this._bbox[2]==t[2]&&this._bbox[3]==t[3]},n.prototype.center=function(e){return this._valid?[(this._bbox[0]+this._bbox[2])/2,(this._bbox[1]+this._bbox[3])/2]:null},n.prototype.union=function(e){var t;return this._valid=!0,t=e instanceof n?e.bbox():e,this._bbox[0]=Math.min(this._bbox[0],t[0]),this._bbox[1]=Math.min(this._bbox[1],t[1]),this._bbox[2]=Math.max(this._bbox[2],t[2]),this._bbox[3]=Math.max(this._bbox[3],t[3]),this},n.prototype.bbox=function(){return this._valid?this._bbox:null},n.prototype.contains=function(e){if(!e)return this._fastContains();if(!this._valid)return null;var t=e[0],n=e[1];return this._bbox[0]<=t&&this._bbox[1]<=n&&this._bbox[2]>=t&&this._bbox[3]>=n},n.prototype.intersect=function(e){return this._valid?(t=e instanceof n?e.bbox():e,!(this._bbox[0]>t[2]||this._bbox[2]<t[0]||this._bbox[3]<t[1]||this._bbox[1]>t[3])):null;var t},n.prototype._fastContains=function(){if(!this._valid)return new Function("return null;");var e="return "+this._bbox[0]+"<= ll[0] &&"+this._bbox[1]+"<= ll[1] &&"+this._bbox[2]+">= ll[0] &&"+this._bbox[3]+">= ll[1]";return new Function("ll",e)},n.prototype.polygon=function(){return this._valid?{type:"Polygon",coordinates:[[[this._bbox[0],this._bbox[1]],[this._bbox[2],this._bbox[1]],[this._bbox[2],this._bbox[3]],[this._bbox[0],this._bbox[3]],[this._bbox[0],this._bbox[1]]]]}:null}},function(e,t){var n=e.exports=function(e){return new o(e)};function o(e){this.value=e}function r(e,t,n){var o=[],r=[],a=!0;return function e(d){var h={},p=!0,g={node:n?i(d):d,node_:d,path:[].concat(o),parent:r[r.length-1],parents:r,key:o.slice(-1)[0],isRoot:0===o.length,level:o.length,circular:null,update:function(e,t){g.isRoot||(g.parent.node[g.key]=e),g.node=e,t&&(p=!1)},delete:function(e){delete g.parent.node[g.key],e&&(p=!1)},remove:function(e){c(g.parent.node)?g.parent.node.splice(g.key,1):delete g.parent.node[g.key],e&&(p=!1)},keys:null,before:function(e){h.before=e},after:function(e){h.after=e},pre:function(e){h.pre=e},post:function(e){h.post=e},stop:function(){a=!1},block:function(){p=!1}};if(!a)return g;function f(){if("object"==typeof g.node&&null!==g.node){g.keys&&g.node_===g.node||(g.keys=s(g.node)),g.isLeaf=0==g.keys.length;for(var e=0;e<r.length;e++)if(r[e].node_===d){g.circular=r[e];break}}else g.isLeaf=!0,g.keys=null;g.notLeaf=!g.isLeaf,g.notRoot=!g.isRoot}f();var y=t.call(g,g.node);return void 0!==y&&g.update&&g.update(y),h.before&&h.before.call(g,g.node),p?("object"!=typeof g.node||null===g.node||g.circular||(r.push(g),f(),u(g.keys,function(t,r){o.push(t),h.pre&&h.pre.call(g,g.node[t],t);var i=e(g.node[t]);n&&l.call(g.node,t)&&(g.node[t]=i.node),i.isLast=r==g.keys.length-1,i.isFirst=0==r,h.post&&h.post.call(g,i),o.pop()}),r.pop()),h.after&&h.after.call(g,g.node),g):g}(e).node}function i(e){if("object"==typeof e&&null!==e){var t;if(c(e))t=[];else if("[object Date]"===a(e))t=new Date(e.getTime?e.getTime():e);else if(function(e){return"[object RegExp]"===a(e)}(e))t=new RegExp(e);else if(function(e){return"[object Error]"===a(e)}(e))t={message:e.message};else if(function(e){return"[object Boolean]"===a(e)}(e))t=new Boolean(e);else if(function(e){return"[object Number]"===a(e)}(e))t=new Number(e);else if(function(e){return"[object String]"===a(e)}(e))t=new String(e);else if(Object.create&&Object.getPrototypeOf)t=Object.create(Object.getPrototypeOf(e));else if(e.constructor===Object)t={};else{var n=e.constructor&&e.constructor.prototype||e.__proto__||{},o=function(){};o.prototype=n,t=new o}return u(s(e),function(n){t[n]=e[n]}),t}return e}o.prototype.get=function(e){for(var t=this.value,n=0;n<e.length;n++){var o=e[n];if(!t||!l.call(t,o)){t=void 0;break}t=t[o]}return t},o.prototype.has=function(e){for(var t=this.value,n=0;n<e.length;n++){var o=e[n];if(!t||!l.call(t,o))return!1;t=t[o]}return!0},o.prototype.set=function(e,t){for(var n=this.value,o=0;o<e.length-1;o++){var r=e[o];l.call(n,r)||(n[r]={}),n=n[r]}return n[e[o]]=t,t},o.prototype.map=function(e){return r(this.value,e,!0)},o.prototype.forEach=function(e){return this.value=r(this.value,e,!1),this.value},o.prototype.reduce=function(e,t){var n=1===arguments.length,o=n?this.value:t;return this.forEach(function(t){this.isRoot&&n||(o=e.call(this,o,t))}),o},o.prototype.paths=function(){var e=[];return this.forEach(function(t){e.push(this.path)}),e},o.prototype.nodes=function(){var e=[];return this.forEach(function(t){e.push(this.node)}),e},o.prototype.clone=function(){var e=[],t=[];return function n(o){for(var r=0;r<e.length;r++)if(e[r]===o)return t[r];if("object"==typeof o&&null!==o){var a=i(o);return e.push(o),t.push(a),u(s(o),function(e){a[e]=n(o[e])}),e.pop(),t.pop(),a}return o}(this.value)};var s=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};function a(e){return Object.prototype.toString.call(e)}var c=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},u=function(e,t){if(e.forEach)return e.forEach(t);for(var n=0;n<e.length;n++)t(e[n],n,e)};u(s(o.prototype),function(e){n[e]=function(t){var n=[].slice.call(arguments,1),r=new o(t);return r[e].apply(r,n)}});var l=Object.hasOwnProperty||function(e,t){return t in e}},function(e,t){e.exports=function(e){return function e(t){if(Array.isArray(t)&&t.length&&"number"==typeof t[0])return[t];return t.reduce(function(t,n){return Array.isArray(n)&&Array.isArray(n[0])?t.concat(e(n)):(t.push(n),t)},[])}(e)}},function(e,t){e.exports=function e(t){switch(t&&t.type||null){case"FeatureCollection":return t.features=t.features.reduce(function(t,n){return t.concat(e(n))},[]),t;case"Feature":return t.geometry?e(t.geometry).map(function(e){return{type:"Feature",properties:JSON.parse(JSON.stringify(t.properties)),geometry:e}}):t;case"MultiPoint":return t.coordinates.map(function(e){return{type:"Point",coordinates:e}});case"MultiPolygon":return t.coordinates.map(function(e){return{type:"Polygon",coordinates:e}});case"MultiLineString":return t.coordinates.map(function(e){return{type:"LineString",coordinates:e}});case"GeometryCollection":return t.geometries.map(e).reduce(function(e,t){return e.concat(t)},[]);case"Point":case"Polygon":case"LineString":return[t]}}},function(e,t,n){var o=n(23),r=n(51),i=n(50);e.exports=function(e){if(!e)return[];var t=[];return r(o(e)).features.forEach(function(e){e.geometry&&(t=t.concat(i(e.geometry.coordinates)))}),t}},function(e,t,n){var o={"./":13,"./btn_ctrl":19,"./btn_ctrl.js":19,"./direct_select":35,"./direct_select.js":35,"./draw_arrow":26,"./draw_arrow.js":26,"./draw_circle":24,"./draw_circle.js":24,"./draw_line_string":34,"./draw_line_string.js":34,"./draw_point":33,"./draw_point.js":33,"./draw_polygon":32,"./draw_polygon.js":32,"./draw_rectangle":25,"./draw_rectangle.js":25,"./draw_sector":28,"./draw_sector.js":28,"./draw_triangle":31,"./draw_triangle.js":31,"./index":13,"./index.js":13,"./mode_interface":17,"./mode_interface.js":17,"./mode_interface_accessors":16,"./mode_interface_accessors.js":16,"./object_to_mode":18,"./object_to_mode.js":18,"./simple_select":27,"./simple_select.js":27};function r(e){var t=i(e);return n(t)}function i(e){var t=o[e];if(!(t+1)){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}return t}r.keys=function(){return Object.keys(o)},r.resolve=i,e.exports=r,r.id=53},function(e,t){e.exports.RADIUS=6378137,e.exports.FLATTENING=1/298.257223563,e.exports.POLAR_RADIUS=6356752.3142}]).default});